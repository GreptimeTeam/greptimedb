CREATE TABLE test (a BIGINT, b INTEGER, time index(a));

MutateResult { success: 1, failure: 0 }

INSERT INTO test VALUES (11, 22), (12, 21), (13, 22);

MutateResult { success: 3, failure: 0 }

select b from test where a = 12;

+-------------------+
| b, #Field, #Int32 |
+-------------------+
| 21                |
+-------------------+

SELECT b FROM test ORDER BY a DESC;

+-------------------+
| b, #Field, #Int32 |
+-------------------+
| 22                |
| 21                |
| 22                |
+-------------------+

SELECT a, b FROM test ORDER BY a;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 11                    | 22                |
| 12                    | 21                |
| 13                    | 22                |
+-----------------------+-------------------+

SELECT a, b FROM test ORDER BY a DESC;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 13                    | 22                |
| 12                    | 21                |
| 11                    | 22                |
+-----------------------+-------------------+

SELECT a, b FROM test ORDER BY b, a;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 12                    | 21                |
| 11                    | 22                |
| 13                    | 22                |
+-----------------------+-------------------+

SELECT a, b FROM test ORDER BY 2, 1;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 12                    | 21                |
| 11                    | 22                |
| 13                    | 22                |
+-----------------------+-------------------+

SELECT a, b FROM test ORDER BY b DESC, a;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 11                    | 22                |
| 13                    | 22                |
| 12                    | 21                |
+-----------------------+-------------------+

SELECT a, b FROM test ORDER BY b, a DESC;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 12                    | 21                |
| 13                    | 22                |
| 11                    | 22                |
+-----------------------+-------------------+

SELECT a, b FROM test ORDER BY b, a DESC LIMIT 1;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 12                    | 21                |
+-----------------------+-------------------+

SELECT a, b FROM test ORDER BY b, a DESC LIMIT 1 OFFSET 1;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 13                    | 22                |
+-----------------------+-------------------+

SELECT a, b FROM test ORDER BY b, a DESC OFFSET 1;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 13                    | 22                |
| 11                    | 22                |
+-----------------------+-------------------+

SELECT a, b FROM test WHERE a < 13 ORDER BY b;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 12                    | 21                |
| 11                    | 22                |
+-----------------------+-------------------+

SELECT a, b FROM test WHERE a < 13 ORDER BY 2;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 12                    | 21                |
| 11                    | 22                |
+-----------------------+-------------------+

SELECT a, b FROM test WHERE a < 13 ORDER BY b DESC;

+-----------------------+-------------------+
| a, #Timestamp, #Int64 | b, #Field, #Int32 |
+-----------------------+-------------------+
| 11                    | 22                |
| 12                    | 21                |
+-----------------------+-------------------+

SELECT b, a FROM test WHERE a < 13 ORDER BY b DESC;

+-------------------+-----------------------+
| b, #Field, #Int32 | a, #Timestamp, #Int64 |
+-------------------+-----------------------+
| 22                | 11                    |
| 21                | 12                    |
+-------------------+-----------------------+

SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY b % 2;

+-------------------+-----------------------------+
| f, #Field, #Int64 | SUM(test.a), #Field, #Int64 |
+-------------------+-----------------------------+
| 0                 | 24                          |
| 1                 | 12                          |
+-------------------+-----------------------------+

SELECT b % 2 AS f, a FROM test ORDER BY b % 2, a;

+-------------------+-----------------------+
| f, #Field, #Int64 | a, #Timestamp, #Int64 |
+-------------------+-----------------------+
| 0                 | 11                    |
| 0                 | 13                    |
| 1                 | 12                    |
+-------------------+-----------------------+

SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY f;

+-------------------+-----------------------------+
| f, #Field, #Int64 | SUM(test.a), #Field, #Int64 |
+-------------------+-----------------------------+
| 0                 | 24                          |
| 1                 | 12                          |
+-------------------+-----------------------------+

SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY 1;

+-------------------+-----------------------------+
| f, #Field, #Int64 | SUM(test.a), #Field, #Int64 |
+-------------------+-----------------------------+
| 0                 | 24                          |
| 1                 | 12                          |
+-------------------+-----------------------------+

SELECT a-10 AS k FROM test UNION SELECT a-10 AS l FROM test ORDER BY k;

+-------------------+
| k, #Field, #Int64 |
+-------------------+
| 1                 |
| 2                 |
| 3                 |
+-------------------+

SELECT a-10 AS k FROM test UNION SELECT a-10 AS l FROM test ORDER BY l;

Failed to execute, error: Datanode { code: 3000, msg: "Failed to execute sql, source: Cannot plan SQL: SELECT a - 10 AS k FROM test UNION SELECT a - 10 AS l FROM test ORDER BY l, source: Schema error: No field named 'l'. Valid fields are 'k'." }

SELECT a-10 AS k FROM test UNION SELECT a-10 AS l FROM test ORDER BY 1-k;

+-------------------+
| k, #Field, #Int64 |
+-------------------+
| 3                 |
| 2                 |
| 1                 |
+-------------------+

SELECT a-10 AS k FROM test UNION SELECT a-10 AS l FROM test ORDER BY a-10;

Failed to execute, error: Datanode { code: 3000, msg: "Failed to execute sql, source: Cannot plan SQL: SELECT a - 10 AS k FROM test UNION SELECT a - 10 AS l FROM test ORDER BY a - 10, source: Schema error: No field named 'a'. Valid fields are 'k'." }

SELECT a-10 AS k FROM test UNION SELECT a-11 AS l FROM test ORDER BY a-11;

Failed to execute, error: Datanode { code: 3000, msg: "Failed to execute sql, source: Cannot plan SQL: SELECT a - 10 AS k FROM test UNION SELECT a - 11 AS l FROM test ORDER BY a - 11, source: Schema error: No field named 'a'. Valid fields are 'k'." }

DROP TABLE test;

MutateResult { success: 1, failure: 0 }

