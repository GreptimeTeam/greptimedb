CREATE TABLE test(i INTEGER, j INTEGER, t BIGINT TIME INDEX);

MutateResult { success: 1, failure: 0 }

INSERT INTO test VALUES (1, 1, 1), (NULL, 1, 2), (1, NULL, 3);

MutateResult { success: 3, failure: 0 }

SELECT * FROM test ORDER BY i NULLS FIRST, j NULLS LAST;

+-------------------+-------------------+-----------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | t, #Timestamp, #Int64 |
+-------------------+-------------------+-----------------------+
| NULL              | 1                 | 2                     |
| 1                 | 1                 | 1                     |
| 1                 | NULL              | 3                     |
+-------------------+-------------------+-----------------------+

SELECT * FROM test ORDER BY i NULLS FIRST, j NULLS FIRST;

+-------------------+-------------------+-----------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | t, #Timestamp, #Int64 |
+-------------------+-------------------+-----------------------+
| NULL              | 1                 | 2                     |
| 1                 | NULL              | 3                     |
| 1                 | 1                 | 1                     |
+-------------------+-------------------+-----------------------+

SELECT * FROM test ORDER BY i NULLS LAST, j NULLS FIRST;

+-------------------+-------------------+-----------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | t, #Timestamp, #Int64 |
+-------------------+-------------------+-----------------------+
| 1                 | NULL              | 3                     |
| 1                 | 1                 | 1                     |
| NULL              | 1                 | 2                     |
+-------------------+-------------------+-----------------------+

SELECT i, j, row_number() OVER (PARTITION BY i ORDER BY j NULLS FIRST) FROM test ORDER BY i NULLS FIRST, j NULLS FIRST;

+-------------------+-------------------+-------------------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | ROW_NUMBER(), #Field, #Uint64 |
+-------------------+-------------------+-------------------------------+
| NULL              | 1                 | 1                             |
| 1                 | NULL              | 1                             |
| 1                 | 1                 | 2                             |
+-------------------+-------------------+-------------------------------+

SELECT i, j, row_number() OVER (PARTITION BY i ORDER BY j NULLS LAST) FROM test ORDER BY i NULLS FIRST, j NULLS FIRST;

+-------------------+-------------------+-------------------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | ROW_NUMBER(), #Field, #Uint64 |
+-------------------+-------------------+-------------------------------+
| NULL              | 1                 | 1                             |
| 1                 | NULL              | 2                             |
| 1                 | 1                 | 1                             |
+-------------------+-------------------+-------------------------------+

SELECT * FROM test ORDER BY i NULLS FIRST, j NULLS LAST LIMIT 2;

+-------------------+-------------------+-----------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | t, #Timestamp, #Int64 |
+-------------------+-------------------+-----------------------+
| NULL              | 1                 | 2                     |
| 1                 | 1                 | 1                     |
+-------------------+-------------------+-----------------------+

SELECT * FROM test ORDER BY i NULLS LAST, j NULLS LAST LIMIT 2;

+-------------------+-------------------+-----------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | t, #Timestamp, #Int64 |
+-------------------+-------------------+-----------------------+
| 1                 | 1                 | 1                     |
| 1                 | NULL              | 3                     |
+-------------------+-------------------+-----------------------+

SELECT * FROM test ORDER BY i;

+-------------------+-------------------+-----------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | t, #Timestamp, #Int64 |
+-------------------+-------------------+-----------------------+
| 1                 | 1                 | 1                     |
| 1                 | NULL              | 3                     |
| NULL              | 1                 | 2                     |
+-------------------+-------------------+-----------------------+

SELECT * FROM test ORDER BY i NULLS FIRST;

+-------------------+-------------------+-----------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | t, #Timestamp, #Int64 |
+-------------------+-------------------+-----------------------+
| NULL              | 1                 | 2                     |
| 1                 | 1                 | 1                     |
| 1                 | NULL              | 3                     |
+-------------------+-------------------+-----------------------+

SELECT * FROM test ORDER BY i NULLS LAST;

+-------------------+-------------------+-----------------------+
| i, #Field, #Int32 | j, #Field, #Int32 | t, #Timestamp, #Int64 |
+-------------------+-------------------+-----------------------+
| 1                 | 1                 | 1                     |
| 1                 | NULL              | 3                     |
| NULL              | 1                 | 2                     |
+-------------------+-------------------+-----------------------+

DROP TABLE test;

MutateResult { success: 1, failure: 0 }

