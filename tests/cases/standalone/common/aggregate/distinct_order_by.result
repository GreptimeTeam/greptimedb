CREATE TABLE integers(i TIMESTAMP TIME INDEX);

Affected Rows: 0

INSERT INTO integers VALUES (1), (2), (3);

Affected Rows: 3

SELECT DISTINCT i%2 FROM integers ORDER BY 1;

Error: 3000(PlanQuery), Error during planning: Cannot coerce arithmetic expression Timestamp(Millisecond, None) % Int64 to valid types

-- TODO(LFC): Failed to run under new DataFusion
-- expected:
--  +-----------------------+
--  | integers.i % Int64(2) |
--  +-----------------------+
--  | 1                     |
--  | 0                     |
--  +-----------------------+
SELECT DISTINCT i % 2 FROM integers WHERE i<3 ORDER BY i;

Error: 3000(PlanQuery), Error during planning: Cannot coerce arithmetic expression Timestamp(Millisecond, None) % Int64 to valid types

SELECT DISTINCT ON (1) i % 2, i FROM integers WHERE i<3 ORDER BY i;

Error: 3000(PlanQuery), Error during planning: Cannot coerce arithmetic expression Timestamp(Millisecond, None) % Int64 to valid types

SELECT DISTINCT integers.i FROM integers ORDER BY i DESC;

+-------------------------+
| i                       |
+-------------------------+
| 1970-01-01T00:00:00.003 |
| 1970-01-01T00:00:00.002 |
| 1970-01-01T00:00:00.001 |
+-------------------------+

SELECT DISTINCT i FROM integers ORDER BY integers.i DESC;

+-------------------------+
| i                       |
+-------------------------+
| 1970-01-01T00:00:00.003 |
| 1970-01-01T00:00:00.002 |
| 1970-01-01T00:00:00.001 |
+-------------------------+

SELECT DISTINCT integers.i FROM integers ORDER BY integers.i DESC;

+-------------------------+
| i                       |
+-------------------------+
| 1970-01-01T00:00:00.003 |
| 1970-01-01T00:00:00.002 |
| 1970-01-01T00:00:00.001 |
+-------------------------+

DROP TABLE integers;

Affected Rows: 1

