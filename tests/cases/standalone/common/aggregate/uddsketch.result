CREATE TABLE test_uddsketch (
    `id` INT PRIMARY KEY,
    `value` DOUBLE,
    `ts` timestamp time index default now()
);

Affected Rows: 0

INSERT INTO test_uddsketch (`id`, `value`) VALUES
    (1, 10.0),
    (2, 20.0),
    (3, 30.0),
    (4, 40.0),
    (5, 50.0),
    (6, 60.0),
    (7, 70.0),
    (8, 80.0),
    (9, 90.0),
    (10, 100.0);

Affected Rows: 10

select uddsketch_state(128, 0.01, `value`) from test_uddsketch;

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| uddsketch_state(Int64(128),Float64(0.01),test_uddsketch.value)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0a0000000000000002000000e100000000000000010000000000000002000000e70000000000000002000000cd00000000000000010000000000000002000000d50000000000000002000000e70000000000000001000000000000000300000002000000d500000000000000010000000000000002000000dc0000000000000002000000c400000000000000010000000000000002000000cd0000000000000002000000b900000000000000010000000000000002000000c40000000000000002000000ab00000000000000010000000000000002000000b90000000000000002000000dc00000000000000010000000000000002000000e1000000000000000200000074000000000000000100000000000000020000009600000000000000020000009600000000000000010000000000000002000000ab000000000000000200000074000000000000007b14ae47e17a843ffd4a815abf52f03f0000000080000000000000000a000000000000000000000000308140 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

select uddsketch_calc(0.1, uddsketch_state(128, 0.01, `value`)) from test_uddsketch;

+---------------------------------------------------------------------------------------------+
| uddsketch_calc(Float64(0.1),uddsketch_state(Int64(128),Float64(0.01),test_uddsketch.value)) |
+---------------------------------------------------------------------------------------------+
| 19.886670240866184                                                                          |
+---------------------------------------------------------------------------------------------+

select uddsketch_calc(0.5, uddsketch_state(128, 0.01, `value`)) from test_uddsketch;

+---------------------------------------------------------------------------------------------+
| uddsketch_calc(Float64(0.5),uddsketch_state(Int64(128),Float64(0.01),test_uddsketch.value)) |
+---------------------------------------------------------------------------------------------+
| 59.745049810145126                                                                          |
+---------------------------------------------------------------------------------------------+

select uddsketch_calc(0.75, uddsketch_state(128, 0.01, `value`)) from test_uddsketch;

+----------------------------------------------------------------------------------------------+
| uddsketch_calc(Float64(0.75),uddsketch_state(Int64(128),Float64(0.01),test_uddsketch.value)) |
+----------------------------------------------------------------------------------------------+
| 80.648188221533                                                                              |
+----------------------------------------------------------------------------------------------+

select uddsketch_calc(0.95, uddsketch_state(128, 0.01, `value`)) from test_uddsketch;

+----------------------------------------------------------------------------------------------+
| uddsketch_calc(Float64(0.95),uddsketch_state(Int64(128),Float64(0.01),test_uddsketch.value)) |
+----------------------------------------------------------------------------------------------+
| 100.49456770856492                                                                           |
+----------------------------------------------------------------------------------------------+

drop table test_uddsketch;

Affected Rows: 0

