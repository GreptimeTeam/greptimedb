CREATE TABLE test(i INTEGER, t TIMESTAMP TIME INDEX);

Affected Rows: 0

INSERT INTO test VALUES (1, 1), (NULL, 2), (1, 3);

Affected Rows: 3

ADMIN FLUSH_TABLE('test');

+---------------------------+
| ADMIN FLUSH_TABLE('test') |
+---------------------------+
| 0                         |
+---------------------------+

INSERT INTO test VALUES (2, 4), (2, 5), (NULL, 6);

Affected Rows: 3

ADMIN FLUSH_TABLE('test');

+---------------------------+
| ADMIN FLUSH_TABLE('test') |
+---------------------------+
| 0                         |
+---------------------------+

INSERT INTO test VALUES (3, 7), (3, 8), (3, 9);

Affected Rows: 3

ADMIN FLUSH_TABLE('test');

+---------------------------+
| ADMIN FLUSH_TABLE('test') |
+---------------------------+
| 0                         |
+---------------------------+

INSERT INTO test VALUES (4, 10), (4, 11), (4, 12);

Affected Rows: 3

SELECT * FROM test ORDER BY t LIMIT 5;

+---+-------------------------+
| i | t                       |
+---+-------------------------+
| 1 | 1970-01-01T00:00:00.001 |
|   | 1970-01-01T00:00:00.002 |
| 1 | 1970-01-01T00:00:00.003 |
| 2 | 1970-01-01T00:00:00.004 |
| 2 | 1970-01-01T00:00:00.005 |
+---+-------------------------+

-- SQLNESS REPLACE (-+) -
-- SQLNESS REPLACE (\s\s+) _
-- SQLNESS REPLACE (peers.*) REDACTED
-- SQLNESS REPLACE (metrics.*) REDACTED
-- SQLNESS REPLACE region=\d+\(\d+,\s+\d+\) region=REDACTED
EXPLAIN ANALYZE SELECT * FROM test ORDER BY t LIMIT 5;

+-+-+-+
| stage | node | plan_|
+-+-+-+
| 0_| 0_|_MergeScanExec: REDACTED
|_|_|_|
| 1_| 0_|_GlobalLimitExec: skip=0, fetch=5 REDACTED
|_|_|_SortPreservingMergeExec: [t@1 ASC NULLS LAST] REDACTED
|_|_|_WindowedSortExec REDACTED
|_|_|_PartSortExec t@1 ASC NULLS LAST REDACTED
|_|_|_SeqScan: region=REDACTED, partition_count=2 (1 memtable ranges, 1 file 1 ranges) REDACTED
|_|_|_|
|_|_| Total rows: 5_|
+-+-+-+

DROP TABLE test;

Affected Rows: 0

