CREATE TABLE test (a BIGINT, b INTEGER, time index(a));

Error: 1004(InvalidArguments), Invalid column option, column name: a, error: time index column data type should be timestamp

INSERT INTO test VALUES (11, 22), (12, 21), (13, 22);

Error: 4001(TableNotFound), Table not found: greptime.public.test

select b from test where a = 12;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT b FROM test ORDER BY a DESC;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test ORDER BY a;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test ORDER BY a DESC;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test ORDER BY b, a;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test ORDER BY 2, 1;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test ORDER BY b DESC, a;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test ORDER BY b, a DESC;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test ORDER BY b, a DESC LIMIT 1;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test ORDER BY b, a DESC LIMIT 1 OFFSET 1;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test ORDER BY b, a DESC OFFSET 1;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test WHERE a < 13 ORDER BY b;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test WHERE a < 13 ORDER BY 2;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a, b FROM test WHERE a < 13 ORDER BY b DESC;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT b, a FROM test WHERE a < 13 ORDER BY b DESC;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY b % 2;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT b % 2 AS f, a FROM test ORDER BY b % 2, a;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY f;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY 1;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

SELECT a-10 AS k FROM test UNION SELECT a-10 AS l FROM test ORDER BY k;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

-- ORDER BY on alias in right-most query
-- CONTROVERSIAL: SQLite allows both "k" and "l" to be referenced here, Postgres and MonetDB give an error.
SELECT a-10 AS k FROM test UNION SELECT a-10 AS l FROM test ORDER BY l;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

-- Not compatible with duckdb, work in gretimedb
SELECT a-10 AS k FROM test UNION SELECT a-10 AS l FROM test ORDER BY 1-k;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

-- Not compatible with duckdb, give an error in greptimedb
-- TODO(LFC): Failed to meet the expected error:
-- expected:
--   Error: 3000(PlanQuery), Schema error: No field named 'a'. Valid fields are 'k'.
SELECT a-10 AS k FROM test UNION SELECT a-10 AS l FROM test ORDER BY a-10;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

-- Not compatible with duckdb, give an error in greptimedb
-- TODO(LFC): Failed to meet the expected error:
-- expected:
--   Error: 3000(PlanQuery), Schema error: No field named 'a'. Valid fields are 'k'.
SELECT a-10 AS k FROM test UNION SELECT a-11 AS l FROM test ORDER BY a-11;

Error: 3000(PlanQuery), Error during planning: Table not found: greptime.public.test

DROP TABLE test;

Error: 4001(TableNotFound), Table not found: greptime.public.test

