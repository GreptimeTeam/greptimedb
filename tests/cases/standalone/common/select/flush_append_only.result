create table
    t (
        ts timestamp time index,
        host string primary key,
        not_pk string,
        val double,
    )
with
    (
        append_mode = 'true',
        'compaction.type' = 'twcs',
        'compaction.twcs.trigger_file_num' = '8',
    );

Affected Rows: 0

insert into
    t
values
    (0, 'a', 'ðŸŒ•', 1.0),
    (1, 'b', 'ðŸŒ–', 2.0),
    (1, 'a', 'ðŸŒ—', 3.0),
    (1, 'c', 'ðŸŒ˜', 4.0),
    (2, 'a', 'ðŸŒ‘', 5.0),
    (2, 'b', 'ðŸŒ’', 6.0),
    (2, 'a', 'ðŸŒ“', 7.0),
    (3, 'c', 'ðŸŒ”', 8.0),
    (3, 'd', 'ðŸŒ•', 9.0);

Affected Rows: 9

admin flush_table ('t');

+------------------------+
| ADMIN flush_table('t') |
+------------------------+
| 0                      |
+------------------------+

insert into
    t
values
    (10, 'a', 'ðŸŒ•', 1.0),
    (11, 'b', 'ðŸŒ–', 2.0),
    (11, 'a', 'ðŸŒ—', 3.0),
    (11, 'c', 'ðŸŒ˜', 4.0),
    (12, 'a', 'ðŸŒ‘', 5.0),
    (12, 'b', 'ðŸŒ’', 6.0),
    (12, 'a', 'ðŸŒ“', 7.0),
    (13, 'c', 'ðŸŒ”', 8.0),
    (13, 'd', 'ðŸŒ•', 9.0);

Affected Rows: 9

admin flush_table ('t');

+------------------------+
| ADMIN flush_table('t') |
+------------------------+
| 0                      |
+------------------------+

select
    count(ts)
from
    t;

+-------------+
| count(t.ts) |
+-------------+
| 18          |
+-------------+

select
    ts
from
    t
order by
    ts;

+-------------------------+
| ts                      |
+-------------------------+
| 1970-01-01T00:00:00     |
| 1970-01-01T00:00:00.001 |
| 1970-01-01T00:00:00.001 |
| 1970-01-01T00:00:00.001 |
| 1970-01-01T00:00:00.002 |
| 1970-01-01T00:00:00.002 |
| 1970-01-01T00:00:00.002 |
| 1970-01-01T00:00:00.003 |
| 1970-01-01T00:00:00.003 |
| 1970-01-01T00:00:00.010 |
| 1970-01-01T00:00:00.011 |
| 1970-01-01T00:00:00.011 |
| 1970-01-01T00:00:00.011 |
| 1970-01-01T00:00:00.012 |
| 1970-01-01T00:00:00.012 |
| 1970-01-01T00:00:00.012 |
| 1970-01-01T00:00:00.013 |
| 1970-01-01T00:00:00.013 |
+-------------------------+

drop table t;

Affected Rows: 0

