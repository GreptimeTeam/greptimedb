create table metric_total (
    ts timestamp time index,
    val double,
);

Affected Rows: 0

insert into metric_total values
    (0, 1),
    (10000, 2);

Affected Rows: 2

tql eval (10, 10, '1s') sum_over_time(metric_total[50s:10s]);

+---------------------+----------------------------------+
| ts                  | prom_sum_over_time(ts_range,val) |
+---------------------+----------------------------------+
| 1970-01-01T00:00:10 | 3.0                              |
+---------------------+----------------------------------+

tql eval (10, 10, '1s') sum_over_time(metric_total[50s:5s]);

+---------------------+----------------------------------+
| ts                  | prom_sum_over_time(ts_range,val) |
+---------------------+----------------------------------+
| 1970-01-01T00:00:10 | 4.0                              |
+---------------------+----------------------------------+

tql eval (300, 300, '1s') sum_over_time(metric_total[50s:10s]);

+---------------------+----------------------------------+
| ts                  | prom_sum_over_time(ts_range,val) |
+---------------------+----------------------------------+
| 1970-01-01T00:05:00 | 10.0                             |
+---------------------+----------------------------------+

tql eval (359, 359, '1s') sum_over_time(metric_total[60s:10s]);

+---------------------+----------------------------------+
| ts                  | prom_sum_over_time(ts_range,val) |
+---------------------+----------------------------------+
| 1970-01-01T00:05:59 | 2.0                              |
+---------------------+----------------------------------+

tql eval (10, 10, '1s') rate(metric_total[20s:10s]);

+---------------------+-----------------------------------------+
| ts                  | prom_rate(ts_range,val,ts,Int64(20000)) |
+---------------------+-----------------------------------------+
| 1970-01-01T00:00:10 | 0.1                                     |
+---------------------+-----------------------------------------+

tql eval (20, 20, '1s') rate(metric_total[20s:5s]);

+---------------------+-----------------------------------------+
| ts                  | prom_rate(ts_range,val,ts,Int64(20000)) |
+---------------------+-----------------------------------------+
| 1970-01-01T00:00:20 | 0.06666666666666667                     |
+---------------------+-----------------------------------------+

drop table metric_total;

Affected Rows: 0

