-- Migrated from DuckDB test: test/sql/types/float/nan_arithmetic.test
-- Test arithmetic on NaN values
-- Test NaN arithmetic with FLOAT
-- Any arithmetic on a NaN value will result in a NaN value
SELECT 'nan'::FLOAT + 1;

+------------------------+
| Utf8("nan") + Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::FLOAT + 'inf'::FLOAT;

+---------------------------+
| Utf8("nan") + Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT 'nan'::FLOAT - 1;

+------------------------+
| Utf8("nan") - Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::FLOAT - 'inf'::FLOAT;

+---------------------------+
| Utf8("nan") - Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT 'nan'::FLOAT * 1;

+------------------------+
| Utf8("nan") * Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::FLOAT * 'inf'::FLOAT;

+---------------------------+
| Utf8("nan") * Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT 'nan'::FLOAT / 1;

+------------------------+
| Utf8("nan") / Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::FLOAT / 'inf'::FLOAT;

+---------------------------+
| Utf8("nan") / Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT 'nan'::FLOAT % 1;

+------------------------+
| Utf8("nan") % Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::FLOAT % 'inf'::FLOAT;

+---------------------------+
| Utf8("nan") % Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT -('nan'::FLOAT);

+-----------------+
| (- Utf8("nan")) |
+-----------------+
| NaN             |
+-----------------+

-- Test NaN arithmetic with DOUBLE
SELECT 'nan'::DOUBLE + 1;

+------------------------+
| Utf8("nan") + Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::DOUBLE + 'inf'::DOUBLE;

+---------------------------+
| Utf8("nan") + Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT 'nan'::DOUBLE - 1;

+------------------------+
| Utf8("nan") - Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::DOUBLE - 'inf'::DOUBLE;

+---------------------------+
| Utf8("nan") - Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT 'nan'::DOUBLE * 1;

+------------------------+
| Utf8("nan") * Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::DOUBLE * 'inf'::DOUBLE;

+---------------------------+
| Utf8("nan") * Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT 'nan'::DOUBLE / 1;

+------------------------+
| Utf8("nan") / Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::DOUBLE / 'inf'::DOUBLE;

+---------------------------+
| Utf8("nan") / Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT 'nan'::DOUBLE % 1;

+------------------------+
| Utf8("nan") % Int64(1) |
+------------------------+
| NaN                    |
+------------------------+

SELECT 'nan'::DOUBLE % 'inf'::DOUBLE;

+---------------------------+
| Utf8("nan") % Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

SELECT -('nan'::DOUBLE);

+-----------------+
| (- Utf8("nan")) |
+-----------------+
| NaN             |
+-----------------+

-- Test infinity arithmetic
SELECT 'inf'::FLOAT + 1;

+------------------------+
| Utf8("inf") + Int64(1) |
+------------------------+
| inf                    |
+------------------------+

SELECT 'inf'::FLOAT - 1;

+------------------------+
| Utf8("inf") - Int64(1) |
+------------------------+
| inf                    |
+------------------------+

SELECT 'inf'::FLOAT * 2;

+------------------------+
| Utf8("inf") * Int64(2) |
+------------------------+
| inf                    |
+------------------------+

SELECT 'inf'::FLOAT / 2;

+------------------------+
| Utf8("inf") / Int64(2) |
+------------------------+
| inf                    |
+------------------------+

SELECT -('inf'::FLOAT);

+-----------------+
| (- Utf8("inf")) |
+-----------------+
| -inf            |
+-----------------+

SELECT 'inf'::DOUBLE + 1;

+------------------------+
| Utf8("inf") + Int64(1) |
+------------------------+
| inf                    |
+------------------------+

SELECT 'inf'::DOUBLE - 1;

+------------------------+
| Utf8("inf") - Int64(1) |
+------------------------+
| inf                    |
+------------------------+

SELECT 'inf'::DOUBLE * 2;

+------------------------+
| Utf8("inf") * Int64(2) |
+------------------------+
| inf                    |
+------------------------+

SELECT 'inf'::DOUBLE / 2;

+------------------------+
| Utf8("inf") / Int64(2) |
+------------------------+
| inf                    |
+------------------------+

SELECT -('inf'::DOUBLE);

+-----------------+
| (- Utf8("inf")) |
+-----------------+
| -inf            |
+-----------------+

-- Test special infinity cases
-- Should be NaN
SELECT 'inf'::FLOAT - 'inf'::FLOAT;

+---------------------------+
| Utf8("inf") - Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

-- Should be NaN
SELECT 'inf'::FLOAT / 'inf'::FLOAT;

+---------------------------+
| Utf8("inf") / Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

-- Should be NaN
SELECT 'inf'::FLOAT * 0;

+------------------------+
| Utf8("inf") * Int64(0) |
+------------------------+
| NaN                    |
+------------------------+

-- Should be NaN
SELECT 'inf'::DOUBLE - 'inf'::DOUBLE;

+---------------------------+
| Utf8("inf") - Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

-- Should be NaN
SELECT 'inf'::DOUBLE / 'inf'::DOUBLE;

+---------------------------+
| Utf8("inf") / Utf8("inf") |
+---------------------------+
| NaN                       |
+---------------------------+

-- Should be NaN
SELECT 'inf'::DOUBLE * 0;

+------------------------+
| Utf8("inf") * Int64(0) |
+------------------------+
| NaN                    |
+------------------------+

