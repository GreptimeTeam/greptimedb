--description: Test TIMESTAMP types
CREATE TABLE IF NOT EXISTS timestamp (sec TIMESTAMP_S, milli TIMESTAMP_MS,micro TIMESTAMP_US, nano TIMESTAMP_NS, ts TIMESTAMP TIME INDEX);

Affected Rows: 0

INSERT INTO timestamp VALUES ('2008-01-01 00:00:01','2008-01-01 00:00:01.594','2008-01-01 00:00:01.88926','2008-01-01 00:00:01.889268321', 1);

Affected Rows: 1

SELECT * from timestamp;

+---------------------+-------------------------+----------------------------+-------------------------------+-------------------------+
| sec                 | milli                   | micro                      | nano                          | ts                      |
+---------------------+-------------------------+----------------------------+-------------------------------+-------------------------+
| 2008-01-01T00:00:01 | 2008-01-01T00:00:01.594 | 2008-01-01T00:00:01.889260 | 2008-01-01T00:00:01.889268321 | 1970-01-01T00:00:00.001 |
+---------------------+-------------------------+----------------------------+-------------------------------+-------------------------+

SELECT extract(YEAR from sec),extract( YEAR from milli),extract(YEAR from nano) from timestamp;

+---------------------------------------+-----------------------------------------+----------------------------------------+
| date_part(Utf8("YEAR"),timestamp.sec) | date_part(Utf8("YEAR"),timestamp.milli) | date_part(Utf8("YEAR"),timestamp.nano) |
+---------------------------------------+-----------------------------------------+----------------------------------------+
| 2008.0                                | 2008.0                                  | 2008.0                                 |
+---------------------------------------+-----------------------------------------+----------------------------------------+

SELECT nano::TIMESTAMP, milli::TIMESTAMP,sec::TIMESTAMP from timestamp;

+-------------------------+-------------------------+---------------------+
| timestamp.nano          | milli                   | timestamp.sec       |
+-------------------------+-------------------------+---------------------+
| 2008-01-01T00:00:01.889 | 2008-01-01T00:00:01.594 | 2008-01-01T00:00:01 |
+-------------------------+-------------------------+---------------------+

SELECT micro::TIMESTAMP_S as m1, micro::TIMESTAMP_MS as m2,micro::TIMESTAMP_NS as m3 from timestamp;

+---------------------+-------------------------+----------------------------+
| m1                  | m2                      | m3                         |
+---------------------+-------------------------+----------------------------+
| 2008-01-01T00:00:01 | 2008-01-01T00:00:01.889 | 2008-01-01T00:00:01.889260 |
+---------------------+-------------------------+----------------------------+

INSERT INTO timestamp VALUES ('2008-01-01 00:00:51','2008-01-01 00:00:01.894','2008-01-01 00:00:01.99926','2008-01-01 00:00:01.999268321', 2);

Affected Rows: 1

INSERT INTO timestamp VALUES ('2008-01-01 00:00:11','2008-01-01 00:00:01.794','2008-01-01 00:00:01.98926','2008-01-01 00:00:01.899268321', 3);

Affected Rows: 1

select '90000-01-19 03:14:07.999999'::TIMESTAMP_US::TIMESTAMP_NS;

Error: 3001(EngineExecuteQuery), DataFusion error: Parser error: Error parsing timestamp from '90000-01-19 03:14:07.999999': error parsing date

select sec::DATE from timestamp;

+---------------+
| timestamp.sec |
+---------------+
| 2008-01-01    |
| 2008-01-01    |
| 2008-01-01    |
+---------------+

select milli::DATE from timestamp;

+-----------------+
| timestamp.milli |
+-----------------+
| 2008-01-01      |
| 2008-01-01      |
| 2008-01-01      |
+-----------------+

select nano::DATE from timestamp;

+----------------+
| timestamp.nano |
+----------------+
| 2008-01-01     |
| 2008-01-01     |
| 2008-01-01     |
+----------------+

select sec::TIME from timestamp;

+---------------+
| timestamp.sec |
+---------------+
| 00:00:01      |
| 00:00:51      |
| 00:00:11      |
+---------------+

select milli::TIME from timestamp;

+-----------------+
| timestamp.milli |
+-----------------+
| 00:00:01.594    |
| 00:00:01.894    |
| 00:00:01.794    |
+-----------------+

select nano::TIME from timestamp;

+--------------------+
| timestamp.nano     |
+--------------------+
| 00:00:01.889268321 |
| 00:00:01.999268321 |
| 00:00:01.899268321 |
+--------------------+

select sec::TIMESTAMP_MS from timestamp;

+---------------------+
| timestamp.sec       |
+---------------------+
| 2008-01-01T00:00:01 |
| 2008-01-01T00:00:51 |
| 2008-01-01T00:00:11 |
+---------------------+

select sec::TIMESTAMP_NS from timestamp;

+---------------------+
| timestamp.sec       |
+---------------------+
| 2008-01-01T00:00:01 |
| 2008-01-01T00:00:51 |
| 2008-01-01T00:00:11 |
+---------------------+

select milli::TIMESTAMP_SEC from timestamp;

+---------------------+
| timestamp.milli     |
+---------------------+
| 2008-01-01T00:00:01 |
| 2008-01-01T00:00:01 |
| 2008-01-01T00:00:01 |
+---------------------+

select milli::TIMESTAMP_NS from timestamp;

+-------------------------+
| timestamp.milli         |
+-------------------------+
| 2008-01-01T00:00:01.594 |
| 2008-01-01T00:00:01.894 |
| 2008-01-01T00:00:01.794 |
+-------------------------+

select nano::TIMESTAMP_SEC from timestamp;

+---------------------+
| timestamp.nano      |
+---------------------+
| 2008-01-01T00:00:01 |
| 2008-01-01T00:00:01 |
| 2008-01-01T00:00:01 |
+---------------------+

select nano::TIMESTAMP_MS from timestamp;

+-------------------------+
| timestamp.nano          |
+-------------------------+
| 2008-01-01T00:00:01.889 |
| 2008-01-01T00:00:01.999 |
| 2008-01-01T00:00:01.899 |
+-------------------------+

select sec from timestamp order by sec;

+---------------------+
| sec                 |
+---------------------+
| 2008-01-01T00:00:01 |
| 2008-01-01T00:00:11 |
| 2008-01-01T00:00:51 |
+---------------------+

select milli from timestamp order by milli;

+-------------------------+
| milli                   |
+-------------------------+
| 2008-01-01T00:00:01.594 |
| 2008-01-01T00:00:01.794 |
| 2008-01-01T00:00:01.894 |
+-------------------------+

select nano from timestamp order by nano;

+-------------------------------+
| nano                          |
+-------------------------------+
| 2008-01-01T00:00:01.889268321 |
| 2008-01-01T00:00:01.899268321 |
| 2008-01-01T00:00:01.999268321 |
+-------------------------------+

INSERT INTO timestamp VALUES ('2008-01-01 00:00:51','2008-01-01 00:00:01.894','2008-01-01 00:00:01.99926','2008-01-01 00:00:01.999268321', 4);

Affected Rows: 1

INSERT INTO timestamp VALUES ('2008-01-01 00:00:11','2008-01-01 00:00:01.794','2008-01-01 00:00:01.98926','2008-01-01 00:00:01.899268321', 5);

Affected Rows: 1

select count(*), nano from timestamp group by nano order by nano;

+----------+-------------------------------+
| COUNT(*) | nano                          |
+----------+-------------------------------+
| 1        | 2008-01-01T00:00:01.889268321 |
| 2        | 2008-01-01T00:00:01.899268321 |
| 2        | 2008-01-01T00:00:01.999268321 |
+----------+-------------------------------+

select count(*), sec from timestamp group by sec order by sec;

+----------+---------------------+
| COUNT(*) | sec                 |
+----------+---------------------+
| 1        | 2008-01-01T00:00:01 |
| 2        | 2008-01-01T00:00:11 |
| 2        | 2008-01-01T00:00:51 |
+----------+---------------------+

select count(*), milli from timestamp group by milli order by milli;

+----------+-------------------------+
| COUNT(*) | milli                   |
+----------+-------------------------+
| 1        | 2008-01-01T00:00:01.594 |
| 2        | 2008-01-01T00:00:01.794 |
| 2        | 2008-01-01T00:00:01.894 |
+----------+-------------------------+

CREATE TABLE IF NOT EXISTS timestamp_two (sec TIMESTAMP_S, milli TIMESTAMP_MS,micro TIMESTAMP_US, nano TIMESTAMP_NS TIME INDEX);

Affected Rows: 0

INSERT INTO timestamp_two VALUES ('2008-01-01 00:00:11','2008-01-01 00:00:01.794','2008-01-01 00:00:01.98926','2008-01-01 00:00:01.899268321');

Affected Rows: 1

select timestamp.sec from timestamp inner join  timestamp_two on (timestamp.sec = timestamp_two.sec);

+---------------------+
| sec                 |
+---------------------+
| 2008-01-01T00:00:11 |
| 2008-01-01T00:00:11 |
+---------------------+

select timestamp.milli from timestamp inner join  timestamp_two on (timestamp.milli = timestamp_two.milli);

+-------------------------+
| milli                   |
+-------------------------+
| 2008-01-01T00:00:01.794 |
| 2008-01-01T00:00:01.794 |
+-------------------------+

select timestamp.nano from timestamp inner join  timestamp_two on (timestamp.nano = timestamp_two.nano);

+-------------------------------+
| nano                          |
+-------------------------------+
| 2008-01-01T00:00:01.899268321 |
| 2008-01-01T00:00:01.899268321 |
+-------------------------------+

select '2008-01-01 00:00:11'::TIMESTAMP_US = '2008-01-01 00:00:11'::TIMESTAMP_MS;

+-----------------------------------------------------------+
| Utf8("2008-01-01 00:00:11") = Utf8("2008-01-01 00:00:11") |
+-----------------------------------------------------------+
| true                                                      |
+-----------------------------------------------------------+

select '2008-01-01 00:00:11'::TIMESTAMP_US = '2008-01-01 00:00:11'::TIMESTAMP_NS;

+-----------------------------------------------------------+
| Utf8("2008-01-01 00:00:11") = Utf8("2008-01-01 00:00:11") |
+-----------------------------------------------------------+
| true                                                      |
+-----------------------------------------------------------+

select '2008-01-01 00:00:11'::TIMESTAMP_US = '2008-01-01 00:00:11'::TIMESTAMP_S;

+-----------------------------------------------------------+
| Utf8("2008-01-01 00:00:11") = Utf8("2008-01-01 00:00:11") |
+-----------------------------------------------------------+
| true                                                      |
+-----------------------------------------------------------+

select '2008-01-01 00:00:11.1'::TIMESTAMP_US = '2008-01-01 00:00:11'::TIMESTAMP_MS;

+-------------------------------------------------------------+
| Utf8("2008-01-01 00:00:11.1") = Utf8("2008-01-01 00:00:11") |
+-------------------------------------------------------------+
| false                                                       |
+-------------------------------------------------------------+

select '2008-01-01 00:00:11.1'::TIMESTAMP_US = '2008-01-01 00:00:11'::TIMESTAMP_NS;

+-------------------------------------------------------------+
| Utf8("2008-01-01 00:00:11.1") = Utf8("2008-01-01 00:00:11") |
+-------------------------------------------------------------+
| false                                                       |
+-------------------------------------------------------------+

select '2008-01-01 00:00:11.1'::TIMESTAMP_US = '2008-01-01 00:00:11.1'::TIMESTAMP_S;

+---------------------------------------------------------------+
| Utf8("2008-01-01 00:00:11.1") = Utf8("2008-01-01 00:00:11.1") |
+---------------------------------------------------------------+
| true                                                          |
+---------------------------------------------------------------+

select '2008-01-01 00:00:11.1'::TIMESTAMP_MS = '2008-01-01 00:00:11'::TIMESTAMP_NS;

+-------------------------------------------------------------+
| Utf8("2008-01-01 00:00:11.1") = Utf8("2008-01-01 00:00:11") |
+-------------------------------------------------------------+
| false                                                       |
+-------------------------------------------------------------+

select '2008-01-01 00:00:11.1'::TIMESTAMP_MS = '2008-01-01 00:00:11'::TIMESTAMP_S;

+-------------------------------------------------------------+
| Utf8("2008-01-01 00:00:11.1") = Utf8("2008-01-01 00:00:11") |
+-------------------------------------------------------------+
| true                                                        |
+-------------------------------------------------------------+

select '2008-01-01 00:00:11.1'::TIMESTAMP_NS = '2008-01-01 00:00:11'::TIMESTAMP_S;

+-------------------------------------------------------------+
| Utf8("2008-01-01 00:00:11.1") = Utf8("2008-01-01 00:00:11") |
+-------------------------------------------------------------+
| true                                                        |
+-------------------------------------------------------------+

select '2008-01-01 00:00:11'::TIMESTAMP_MS = '2008-01-01 00:00:11'::TIMESTAMP_NS;

+-----------------------------------------------------------+
| Utf8("2008-01-01 00:00:11") = Utf8("2008-01-01 00:00:11") |
+-----------------------------------------------------------+
| true                                                      |
+-----------------------------------------------------------+

select '2008-01-01 00:00:11'::TIMESTAMP_MS = '2008-01-01 00:00:11'::TIMESTAMP_S;

+-----------------------------------------------------------+
| Utf8("2008-01-01 00:00:11") = Utf8("2008-01-01 00:00:11") |
+-----------------------------------------------------------+
| true                                                      |
+-----------------------------------------------------------+

select '2008-01-01 00:00:11'::TIMESTAMP_NS = '2008-01-01 00:00:11'::TIMESTAMP_S;

+-----------------------------------------------------------+
| Utf8("2008-01-01 00:00:11") = Utf8("2008-01-01 00:00:11") |
+-----------------------------------------------------------+
| true                                                      |
+-----------------------------------------------------------+

DROP TABLE timestamp;

Affected Rows: 0

DROP TABLE timestamp_two;

Affected Rows: 0

