-- common test
SELECT INTERVAL '1 year 2 months 3 days 4 hours 5 minutes 6 seconds 100 microseconds';

+---------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 14, days: 3, nanoseconds: 14706000100000 }") |
+---------------------------------------------------------------------------------------------------+
| 14 mons 3 days 4 hours 5 mins 6.000100000 secs                                                    |
+---------------------------------------------------------------------------------------------------+

SELECT INTERVAL '1.5 year';

+--------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 18, days: 0, nanoseconds: 0 }") |
+--------------------------------------------------------------------------------------+
| 18 mons                                                                              |
+--------------------------------------------------------------------------------------+

SELECT INTERVAL '-2 months';

+--------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: -2, days: 0, nanoseconds: 0 }") |
+--------------------------------------------------------------------------------------+
| -2 mons                                                                              |
+--------------------------------------------------------------------------------------+

SELECT '3 hours'::INTERVAL;

+-----------------+
| Utf8("3 hours") |
+-----------------+
| 3 hours         |
+-----------------+

SELECT INTERVAL '1 year 2 months 3 days 4 hours' + INTERVAL '1 year';

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 14, days: 3, nanoseconds: 14400000000000 }") + IntervalMonthDayNano("IntervalMonthDayNano { months: 12, days: 0, nanoseconds: 0 }") |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 26 mons 3 days 4 hours                                                                                                                                                                   |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

SELECT INTERVAL '1 year 2 months 3 days 4 hours' - INTERVAL '1 year';

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 14, days: 3, nanoseconds: 14400000000000 }") - IntervalMonthDayNano("IntervalMonthDayNano { months: 12, days: 0, nanoseconds: 0 }") |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2 mons 3 days 4 hours                                                                                                                                                                    |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

SELECT INTERVAL '6 years' * 2;

Error: 3000(PlanQuery), Failed to plan SQL: Error during planning: Cannot coerce arithmetic expression Interval(MonthDayNano) * Int64 to valid types

SELECT INTERVAL '6 years' / 2;

Error: 3000(PlanQuery), Failed to plan SQL: Error during planning: Cannot coerce arithmetic expression Interval(MonthDayNano) / Int64 to valid types

SELECT INTERVAL '6 years' = INTERVAL '72 months';

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 72, days: 0, nanoseconds: 0 }") = IntervalMonthDayNano("IntervalMonthDayNano { months: 72, days: 0, nanoseconds: 0 }") |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| true                                                                                                                                                                        |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

SELECT arrow_typeof(INTERVAL '1 month');

+---------------------------------------------------------------------------------------------------+
| arrow_typeof(IntervalMonthDayNano("IntervalMonthDayNano { months: 1, days: 0, nanoseconds: 0 }")) |
+---------------------------------------------------------------------------------------------------+
| Interval(MonthDayNano)                                                                            |
+---------------------------------------------------------------------------------------------------+

-- INTERVAL + TIME CONSTANT
SELECT current_time() + INTERVAL '1 hour';

Error: 3000(PlanQuery), Failed to plan SQL: Error during planning: Cannot coerce arithmetic expression Time64(Nanosecond) + Interval(MonthDayNano) to valid types

-- table with interval type test
-- breaking change from #5422 table do not support interval type will raise an error
CREATE TABLE IF NOT EXISTS intervals(
  ts TIMESTAMP TIME INDEX,
  interval_value INTERVAL,
);

Error: 1004(InvalidArguments), Invalid SQL, error: column name `interval_value` is interval type, which is not supported

-- Interval shortened names
SELECT INTERVAL '55h';

+---------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 0, nanoseconds: 198000000000000 }") |
+---------------------------------------------------------------------------------------------------+
| 55 hours                                                                                          |
+---------------------------------------------------------------------------------------------------+

SELECT INTERVAL '-2mon';

+--------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: -2, days: 0, nanoseconds: 0 }") |
+--------------------------------------------------------------------------------------+
| -2 mons                                                                              |
+--------------------------------------------------------------------------------------+

SELECT INTERVAL '-1h5m';

+--------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 0, nanoseconds: -3300000000000 }") |
+--------------------------------------------------------------------------------------------------+
| -55 mins                                                                                         |
+--------------------------------------------------------------------------------------------------+

SELECT INTERVAL '-1h-5m';

+--------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 0, nanoseconds: -3900000000000 }") |
+--------------------------------------------------------------------------------------------------+
| -1 hours -5 mins                                                                                 |
+--------------------------------------------------------------------------------------------------+

SELECT INTERVAL '1y2w3d4h';

+----------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 12, days: 17, nanoseconds: 14400000000000 }") |
+----------------------------------------------------------------------------------------------------+
| 12 mons 17 days 4 hours                                                                            |
+----------------------------------------------------------------------------------------------------+

SELECT '3y2mon'::INTERVAL;

+--------------------------+
| Utf8("3 years 2 months") |
+--------------------------+
| 38 mons                  |
+--------------------------+

SELECT INTERVAL '7 days' - INTERVAL '1d';

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 7, nanoseconds: 0 }") - IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 1, nanoseconds: 0 }") |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 6 days                                                                                                                                                                    |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

SELECT INTERVAL '2h' + INTERVAL '1h';

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 0, nanoseconds: 7200000000000 }") + IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 0, nanoseconds: 3600000000000 }") |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 3 hours                                                                                                                                                                                           |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

-- Interval ISO 8601
SELECT INTERVAL 'p3y3m700dt133h17m36.789s';

+------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 0, nanoseconds: 163343856789000000 }") |
+------------------------------------------------------------------------------------------------------+
| 45373 hours 17 mins 36.789000000 secs                                                                |
+------------------------------------------------------------------------------------------------------+

SELECT INTERVAL '-P3Y3M700DT133H17M36.789S';

+-------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 0, nanoseconds: -163343856789000000 }") |
+-------------------------------------------------------------------------------------------------------+
| -45373 hours -17 mins -36.789000000 secs                                                              |
+-------------------------------------------------------------------------------------------------------+

SELECT 'P3Y3M700DT133H17M36.789S'::INTERVAL;

+---------------------------------------+
| Utf8("163343856789 milliseconds")     |
+---------------------------------------+
| 45373 hours 17 mins 36.789000000 secs |
+---------------------------------------+

SELECT INTERVAL '2h' + INTERVAL 'P3Y3M700DT133H17M36.789S';

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 0, nanoseconds: 7200000000000 }") + IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 0, nanoseconds: 163343856789000000 }") |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 45375 hours 17 mins 36.789000000 secs                                                                                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '1 days'::interval;

+-----------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + Utf8("1 days") |
+-----------------------------------------------------------------------------------------------+
| 2022-01-02T00:00:01                                                                           |
+-----------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '2 days'::interval;

+-----------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + Utf8("2 days") |
+-----------------------------------------------------------------------------------------------+
| 2022-01-03T00:00:01                                                                           |
+-----------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp - '1 days'::interval;

+-----------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) - Utf8("1 days") |
+-----------------------------------------------------------------------------------------------+
| 2021-12-31T00:00:01                                                                           |
+-----------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp - '2 days'::interval;

+-----------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) - Utf8("2 days") |
+-----------------------------------------------------------------------------------------------+
| 2021-12-30T00:00:01                                                                           |
+-----------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '1 month'::interval;

+------------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + Utf8("1 month") |
+------------------------------------------------------------------------------------------------+
| 2022-02-01T00:00:01                                                                            |
+------------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '2 months'::interval;

+-------------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + Utf8("2 months") |
+-------------------------------------------------------------------------------------------------+
| 2022-03-01T00:00:01                                                                             |
+-------------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '1 year'::interval;

+-----------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + Utf8("1 year") |
+-----------------------------------------------------------------------------------------------+
| 2023-01-01T00:00:01                                                                           |
+-----------------------------------------------------------------------------------------------+

select '2023-01-01T00:00:01'::timestamp + '2 years'::interval;

+------------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2023-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + Utf8("2 years") |
+------------------------------------------------------------------------------------------------+
| 2025-01-01T00:00:01                                                                            |
+------------------------------------------------------------------------------------------------+

-- DATE + INTERVAL
SELECT DATE '2000-10-30' + '1 days'::interval;

+-------------------------------------+
| Utf8("2000-10-30") + Utf8("1 days") |
+-------------------------------------+
| 2000-10-31                          |
+-------------------------------------+

SELECT DATE '2000-10-30' + '2 months'::interval;

+---------------------------------------+
| Utf8("2000-10-30") + Utf8("2 months") |
+---------------------------------------+
| 2000-12-30                            |
+---------------------------------------+

SELECT DATE '2000-10-30' + '2 years'::interval;

+--------------------------------------+
| Utf8("2000-10-30") + Utf8("2 years") |
+--------------------------------------+
| 2002-10-30                           |
+--------------------------------------+

-- DATE - INTERVAL
SELECT DATE '2000-10-30' - '1 days'::interval;

+-------------------------------------+
| Utf8("2000-10-30") - Utf8("1 days") |
+-------------------------------------+
| 2000-10-29                          |
+-------------------------------------+

SELECT DATE '2000-10-30' - '2 months'::interval;

+---------------------------------------+
| Utf8("2000-10-30") - Utf8("2 months") |
+---------------------------------------+
| 2000-08-30                            |
+---------------------------------------+

SELECT DATE '2000-10-30' - '2 years'::interval;

+--------------------------------------+
| Utf8("2000-10-30") - Utf8("2 years") |
+--------------------------------------+
| 1998-10-30                           |
+--------------------------------------+

