-- common test
SELECT INTERVAL '1 year 2 months 3 days 4 hours 5 minutes 6 seconds 100 microseconds';

+---------------------------------------------------------+
| IntervalMonthDayNano("1109194275255040973236744059552") |
+---------------------------------------------------------+
| 0 years 14 mons 3 days 4 hours 5 mins 6.000100000 secs  |
+---------------------------------------------------------+

SELECT INTERVAL '1.5 year';

+---------------------------------------------------------+
| IntervalMonthDayNano("1426106925256758076683791106048") |
+---------------------------------------------------------+
| 0 years 18 mons 0 days 0 hours 0 mins 0.000000000 secs  |
+---------------------------------------------------------+

SELECT INTERVAL '-2 months';

+---------------------------------------------------------+
| IntervalMonthDayNano("-158456325028528675187087900672") |
+---------------------------------------------------------+
| 0 years -2 mons 0 days 0 hours 0 mins 0.000000000 secs  |
+---------------------------------------------------------+

SELECT '3 hours'::INTERVAL;

+-------------------------------------------------------+
| IntervalMonthDayNano("10800000000000")                |
+-------------------------------------------------------+
| 0 years 0 mons 0 days 3 hours 0 mins 0.000000000 secs |
+-------------------------------------------------------+

SELECT INTERVAL '1 year 2 months 3 days 4 hours' + INTERVAL '1 year';

+------------------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("1109194275255040972930743959552") + IntervalMonthDayNano("950737950171172051122527404032") |
+------------------------------------------------------------------------------------------------------------------+
| 0 years 26 mons 3 days 4 hours 0 mins 0.000000000 secs                                                           |
+------------------------------------------------------------------------------------------------------------------+

SELECT INTERVAL '1 year 2 months 3 days 4 hours' - INTERVAL '1 year';

+------------------------------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("1109194275255040972930743959552") - IntervalMonthDayNano("950737950171172051122527404032") |
+------------------------------------------------------------------------------------------------------------------+
| 0 years 2 mons 3 days 4 hours 0 mins 0.000000000 secs                                                            |
+------------------------------------------------------------------------------------------------------------------+

SELECT INTERVAL '6 years' * 2;

Error: 1001(Unsupported), Failed to plan SQL: This feature is not implemented: Unsupported interval operator: Multiply

SELECT INTERVAL '6 years' / 2;

Error: 1001(Unsupported), Failed to plan SQL: This feature is not implemented: Unsupported interval operator: Divide

SELECT INTERVAL '6 years' = INTERVAL '72 months';

Error: 1001(Unsupported), Failed to plan SQL: This feature is not implemented: Unsupported interval operator: Eq

SELECT arrow_typeof(INTERVAL '1 month');

+---------------------------------------------------------------------+
| arrow_typeof(IntervalMonthDayNano("79228162514264337593543950336")) |
+---------------------------------------------------------------------+
| Interval(MonthDayNano)                                              |
+---------------------------------------------------------------------+

-- INTERVAL + TIME CONSTANT
SELECT current_time() + INTERVAL '1 hour';

Error: 3000(PlanQuery), Failed to plan SQL: Error during planning: Cannot coerce arithmetic expression Time64(Nanosecond) + Interval(MonthDayNano) to valid types

-- table with interval type test
-- breaking change from #5422 table do not support interval type will raise an error
CREATE TABLE IF NOT EXISTS intervals(
  ts TIMESTAMP TIME INDEX,
  interval_value INTERVAL,
);

Error: 1004(InvalidArguments), Invalid SQL, error: column name `interval_value` is interval type, which is not supported

-- Interval shortened names
SELECT INTERVAL '55h';

+--------------------------------------------------------+
| IntervalMonthDayNano("198000000000000")                |
+--------------------------------------------------------+
| 0 years 0 mons 0 days 55 hours 0 mins 0.000000000 secs |
+--------------------------------------------------------+

SELECT INTERVAL '-2mon';

+---------------------------------------------------------+
| IntervalMonthDayNano("-158456325028528675187087900672") |
+---------------------------------------------------------+
| 0 years -2 mons 0 days 0 hours 0 mins 0.000000000 secs  |
+---------------------------------------------------------+

SELECT INTERVAL '-1h5m';

+---------------------------------------------------------+
| IntervalMonthDayNano("18446740773709551616")            |
+---------------------------------------------------------+
| 0 years 0 mons 0 days 0 hours -55 mins 0.000000000 secs |
+---------------------------------------------------------+

SELECT INTERVAL '-1h-5m';

+---------------------------------------------------------+
| IntervalMonthDayNano("18446740173709551616")            |
+---------------------------------------------------------+
| 0 years 0 mons 0 days -1 hours -5 mins 0.000000000 secs |
+---------------------------------------------------------+

SELECT INTERVAL '1y2w3d4h';

+---------------------------------------------------------+
| IntervalMonthDayNano("950737950484766714775589781504")  |
+---------------------------------------------------------+
| 0 years 12 mons 17 days 4 hours 0 mins 0.000000000 secs |
+---------------------------------------------------------+

SELECT '3y2mon'::INTERVAL;

+---------------------------------------------------------+
| IntervalMonthDayNano("3010670175542044828554670112768") |
+---------------------------------------------------------+
| 0 years 38 mons 0 days 0 hours 0 mins 0.000000000 secs  |
+---------------------------------------------------------+

SELECT INTERVAL '7 days' - INTERVAL '1d';

+----------------------------------------------------------------------------------------------+
| IntervalMonthDayNano("129127208515966861312") - IntervalMonthDayNano("18446744073709551616") |
+----------------------------------------------------------------------------------------------+
| 0 years 0 mons 6 days 0 hours 0 mins 0.000000000 secs                                        |
+----------------------------------------------------------------------------------------------+

SELECT INTERVAL '2h' + INTERVAL '1h';

+-------------------------------------------------------------------------------+
| IntervalMonthDayNano("7200000000000") + IntervalMonthDayNano("3600000000000") |
+-------------------------------------------------------------------------------+
| 0 years 0 mons 0 days 3 hours 0 mins 0.000000000 secs                         |
+-------------------------------------------------------------------------------+

-- Interval ISO 8601
SELECT INTERVAL 'p3y3m700dt133h17m36.789s';

+-------------------------------------------------------------+
| IntervalMonthDayNano("163343856789000000")                  |
+-------------------------------------------------------------+
| 0 years 0 mons 0 days 45373 hours 17 mins 36.789000000 secs |
+-------------------------------------------------------------+

SELECT INTERVAL '-P3Y3M700DT133H17M36.789S';

+----------------------------------------------------------------+
| IntervalMonthDayNano("18283400216920551616")                   |
+----------------------------------------------------------------+
| 0 years 0 mons 0 days -45373 hours -17 mins -36.789000000 secs |
+----------------------------------------------------------------+

SELECT 'P3Y3M700DT133H17M36.789S'::INTERVAL;

+-------------------------------------------------------------+
| IntervalMonthDayNano("163343856789000000")                  |
+-------------------------------------------------------------+
| 0 years 0 mons 0 days 45373 hours 17 mins 36.789000000 secs |
+-------------------------------------------------------------+

SELECT INTERVAL '2h' + INTERVAL 'P3Y3M700DT133H17M36.789S';

+------------------------------------------------------------------------------------+
| IntervalMonthDayNano("7200000000000") + IntervalMonthDayNano("163343856789000000") |
+------------------------------------------------------------------------------------+
| 0 years 0 mons 0 days 45375 hours 17 mins 36.789000000 secs                        |
+------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '1 days'::interval;

+-----------------------------------------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + IntervalMonthDayNano("18446744073709551616") |
+-----------------------------------------------------------------------------------------------------------------------------+
| 2022-01-02T00:00:01                                                                                                         |
+-----------------------------------------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '2 days'::interval;

+-----------------------------------------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + IntervalMonthDayNano("36893488147419103232") |
+-----------------------------------------------------------------------------------------------------------------------------+
| 2022-01-03T00:00:01                                                                                                         |
+-----------------------------------------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '1 month'::interval;

+--------------------------------------------------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + IntervalMonthDayNano("79228162514264337593543950336") |
+--------------------------------------------------------------------------------------------------------------------------------------+
| 2022-02-01T00:00:01                                                                                                                  |
+--------------------------------------------------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '2 months'::interval;

+---------------------------------------------------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + IntervalMonthDayNano("158456325028528675187087900672") |
+---------------------------------------------------------------------------------------------------------------------------------------+
| 2022-03-01T00:00:01                                                                                                                   |
+---------------------------------------------------------------------------------------------------------------------------------------+

select '2022-01-01T00:00:01'::timestamp + '1 year'::interval;

+---------------------------------------------------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2022-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + IntervalMonthDayNano("950737950171172051122527404032") |
+---------------------------------------------------------------------------------------------------------------------------------------+
| 2023-01-01T00:00:01                                                                                                                   |
+---------------------------------------------------------------------------------------------------------------------------------------+

select '2023-01-01T00:00:01'::timestamp + '2 years'::interval;

+----------------------------------------------------------------------------------------------------------------------------------------+
| arrow_cast(Utf8("2023-01-01T00:00:01"),Utf8("Timestamp(Millisecond, None)")) + IntervalMonthDayNano("1901475900342344102245054808064") |
+----------------------------------------------------------------------------------------------------------------------------------------+
| 2025-01-01T00:00:01                                                                                                                    |
+----------------------------------------------------------------------------------------------------------------------------------------+

