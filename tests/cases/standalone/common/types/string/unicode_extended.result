-- Migrated from DuckDB test: test/sql/types/string/test_unicode.test
-- Test Unicode string handling
-- Test basic Unicode strings
CREATE TABLE unicode_test(s VARCHAR, ts TIMESTAMP TIME INDEX);

Affected Rows: 0

INSERT INTO unicode_test VALUES
    ('Hello ä¸–ç•Œ', 1000),
    ('Ã‘Ã±Ã±Ã±', 2000),
    ('ğŸš€ğŸ‰ğŸŒŸ', 3000),
    ('Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹ Ğ¼Ğ¸Ñ€', 4000),
    ('Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…', 5000),
    ('ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ', 6000);

Affected Rows: 6

-- Test basic selection
SELECT s FROM unicode_test ORDER BY ts;

+----------------+
| s              |
+----------------+
| Hello ä¸–ç•Œ     |
| Ã‘Ã±Ã±Ã±           |
| ğŸš€ğŸ‰ğŸŒŸ         |
| Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹ Ğ¼Ğ¸Ñ€ |
| Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…  |
| ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ |
+----------------+

-- Test length function with Unicode
SELECT s, LENGTH(s) AS a, CHAR_LENGTH(s) AS b FROM unicode_test ORDER BY ts;

+----------------+----+----+
| s              | a  | b  |
+----------------+----+----+
| Hello ä¸–ç•Œ     | 8  | 8  |
| Ã‘Ã±Ã±Ã±           | 4  | 4  |
| ğŸš€ğŸ‰ğŸŒŸ         | 3  | 3  |
| Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹ Ğ¼Ğ¸Ñ€ | 14 | 14 |
| Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…  | 13 | 13 |
| ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ | 7  | 7  |
+----------------+----+----+

-- Test substring with Unicode
SELECT s, SUBSTRING(s, 1, 5) FROM unicode_test ORDER BY ts;

+----------------+------------------------------------------+
| s              | substr(unicode_test.s,Int64(1),Int64(5)) |
+----------------+------------------------------------------+
| Hello ä¸–ç•Œ     | Hello                                    |
| Ã‘Ã±Ã±Ã±           | Ã‘Ã±Ã±Ã±                                     |
| ğŸš€ğŸ‰ğŸŒŸ         | ğŸš€ğŸ‰ğŸŒŸ                                   |
| Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹ Ğ¼Ğ¸Ñ€ | Ğ—Ğ´Ñ€Ğ°Ğ²                                    |
| Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…  | Ù…Ø±Ø­Ø¨Ø§                                    |
| ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ | ã“ã‚“ã«ã¡ã¯                               |
+----------------+------------------------------------------+

-- Test UPPER/LOWER with Unicode
SELECT s, UPPER(s), LOWER(s) FROM unicode_test WHERE s = 'Hello ä¸–ç•Œ';

+------------+-----------------------+-----------------------+
| s          | upper(unicode_test.s) | lower(unicode_test.s) |
+------------+-----------------------+-----------------------+
| Hello ä¸–ç•Œ | HELLO ä¸–ç•Œ            | hello ä¸–ç•Œ            |
+------------+-----------------------+-----------------------+

-- Test comparison with Unicode
SELECT COUNT(*) FROM unicode_test WHERE s LIKE '%ä¸–ç•Œ%';

+----------+
| count(*) |
+----------+
| 2        |
+----------+

SELECT COUNT(*) FROM unicode_test WHERE s LIKE '%ğŸš€%';

+----------+
| count(*) |
+----------+
| 1        |
+----------+

-- Test concatenation with Unicode
SELECT CONCAT(s, ' - test') FROM unicode_test ORDER BY ts;

+----------------------------------------+
| concat(unicode_test.s,Utf8(" - test")) |
+----------------------------------------+
| Hello ä¸–ç•Œ - test                      |
| Ã‘Ã±Ã±Ã± - test                            |
| ğŸš€ğŸ‰ğŸŒŸ - test                          |
| Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹ Ğ¼Ğ¸Ñ€ - test                  |
| Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù… - test                   |
| ã“ã‚“ã«ã¡ã¯ä¸–ç•Œ - test                  |
+----------------------------------------+

DROP TABLE unicode_test;

Affected Rows: 0

