-- Some cases port from https://github.com/duckdb/duckdb/blob/main/test/sql/types/decimal/test_decimal_ops.test
CREATE TABLE decimals(d DECIMAL(3, 2), ts timestamp time index);

Affected Rows: 0

INSERT INTO decimals VALUES ('0.1',1000), ('0.2',2000);

Affected Rows: 2

-- SQLNESS SORT_RESULT 3 1
SELECT * FROM decimals;

+------+---------------------+
| d    | ts                  |
+------+---------------------+
| 0.10 | 1970-01-01T00:00:01 |
| 0.20 | 1970-01-01T00:00:02 |
+------+---------------------+

-- ORDER BY
SELECT * FROM decimals ORDER BY d DESC;

+------+---------------------+
| d    | ts                  |
+------+---------------------+
| 0.20 | 1970-01-01T00:00:02 |
| 0.10 | 1970-01-01T00:00:01 |
+------+---------------------+

-- equality
SELECT * FROM decimals WHERE d = '0.1'::DECIMAL(3,2);

+------+---------------------+
| d    | ts                  |
+------+---------------------+
| 0.10 | 1970-01-01T00:00:01 |
+------+---------------------+

-- greater than equals
-- SQLNESS SORT_RESULT 3 1
SELECT * FROM decimals WHERE d >= '0.1'::DECIMAL(3,2);

+------+---------------------+
| d    | ts                  |
+------+---------------------+
| 0.10 | 1970-01-01T00:00:01 |
| 0.20 | 1970-01-01T00:00:02 |
+------+---------------------+

-- what about if we use different decimal scales?
SELECT * FROM decimals WHERE d = '0.1'::DECIMAL(9,5);

+------+---------------------+
| d    | ts                  |
+------+---------------------+
| 0.10 | 1970-01-01T00:00:01 |
+------+---------------------+

SELECT * FROM decimals WHERE d >= '0.1'::DECIMAL(9,5) ORDER BY 1;

+------+---------------------+
| d    | ts                  |
+------+---------------------+
| 0.10 | 1970-01-01T00:00:01 |
| 0.20 | 1970-01-01T00:00:02 |
+------+---------------------+

-- what if we compare decimals with different scales and width (3,2) vs (9,1)
INSERT INTO decimals VALUES ('0.11',3000), ('0.21',4000);

Affected Rows: 2

SELECT * FROM decimals WHERE d = '0.1'::DECIMAL(9,1);

+------+---------------------+
| d    | ts                  |
+------+---------------------+
| 0.10 | 1970-01-01T00:00:01 |
+------+---------------------+

SELECT * FROM decimals WHERE d > '0.1'::DECIMAL(9,1) ORDER BY 1;

+------+---------------------+
| d    | ts                  |
+------+---------------------+
| 0.11 | 1970-01-01T00:00:03 |
| 0.20 | 1970-01-01T00:00:02 |
| 0.21 | 1970-01-01T00:00:04 |
+------+---------------------+

DELETE FROM decimals WHERE d <> d::DECIMAL(9,1);

Affected Rows: 2

SELECT * FROM decimals;

+------+---------------------+
| d    | ts                  |
+------+---------------------+
| 0.10 | 1970-01-01T00:00:01 |
| 0.20 | 1970-01-01T00:00:02 |
+------+---------------------+

-- test ABS function
SELECT ABS('-0.1'::DECIMAL), ABS('0.1'::DECIMAL), ABS(NULL::DECIMAL);

+-------------------+------------------+-----------+
| abs(Utf8("-0.1")) | abs(Utf8("0.1")) | abs(NULL) |
+-------------------+------------------+-----------+
| 0.1000000000      | 0.1000000000     |           |
+-------------------+------------------+-----------+

SELECT ABS('-0.1'::DECIMAL(4,3)) AS col1, ABS('-0.1'::DECIMAL(9,3)) AS col2, ABS('-0.1'::DECIMAL(18,3)) AS col3, ABS('-0.1'::DECIMAL(38,3)) AS col4;

+-------+-------+-------+-------+
| col1  | col2  | col3  | col4  |
+-------+-------+-------+-------+
| 0.100 | 0.100 | 0.100 | 0.100 |
+-------+-------+-------+-------+

-- test CEIL function
SELECT CEIL('0.1'::DECIMAL), CEIL('-0.1'::DECIMAL), CEIL(NULL::DECIMAL);

+-------------------+--------------------+------------+
| ceil(Utf8("0.1")) | ceil(Utf8("-0.1")) | ceil(NULL) |
+-------------------+--------------------+------------+
| 1.0               | -0.0               |            |
+-------------------+--------------------+------------+

SELECT CEIL('100.3'::DECIMAL), CEIL('-127012.3'::DECIMAL);

+---------------------+-------------------------+
| ceil(Utf8("100.3")) | ceil(Utf8("-127012.3")) |
+---------------------+-------------------------+
| 101.0               | -127012.0               |
+---------------------+-------------------------+

SELECT CEIL('10.5'::DECIMAL), CEIL('-10.5'::DECIMAL);

+--------------------+---------------------+
| ceil(Utf8("10.5")) | ceil(Utf8("-10.5")) |
+--------------------+---------------------+
| 11.0               | -10.0               |
+--------------------+---------------------+

-- ceil function on the boundaries
SELECT CEIL('999.9'::DECIMAL(4,1)), CEIL('99999999.9'::DECIMAL(9,1)), CEIL('99999999999999999.9'::DECIMAL(18,1)), CEIL('9999999999999999999999999999999999999.9'::DECIMAL(38,1));

+---------------------+--------------------------+-----------------------------------+-------------------------------------------------------+
| ceil(Utf8("999.9")) | ceil(Utf8("99999999.9")) | ceil(Utf8("99999999999999999.9")) | ceil(Utf8("9999999999999999999999999999999999999.9")) |
+---------------------+--------------------------+-----------------------------------+-------------------------------------------------------+
| 1000.0              | 100000000.0              | 1e17                              | 1e37                                                  |
+---------------------+--------------------------+-----------------------------------+-------------------------------------------------------+

SELECT CEIL('-999.9'::DECIMAL(4,1)), CEIL('-99999999.9'::DECIMAL(9,1)), CEIL('-99999999999999999.9'::DECIMAL(18,1)), CEIL('-9999999999999999999999999999999999999.9'::DECIMAL(38,1));

+----------------------+---------------------------+------------------------------------+--------------------------------------------------------+
| ceil(Utf8("-999.9")) | ceil(Utf8("-99999999.9")) | ceil(Utf8("-99999999999999999.9")) | ceil(Utf8("-9999999999999999999999999999999999999.9")) |
+----------------------+---------------------------+------------------------------------+--------------------------------------------------------+
| -999.0               | -99999999.0               | -1e17                              | -1e37                                                  |
+----------------------+---------------------------+------------------------------------+--------------------------------------------------------+

-- test FLOOR function
SELECT FLOOR('0.1'::DECIMAL), FLOOR('-0.1'::DECIMAL), FLOOR(NULL::DECIMAL);

+--------------------+---------------------+-------------+
| floor(Utf8("0.1")) | floor(Utf8("-0.1")) | floor(NULL) |
+--------------------+---------------------+-------------+
| 0.0                | -1.0                |             |
+--------------------+---------------------+-------------+

SELECT FLOOR('100.3'::DECIMAL), FLOOR('-127012.3'::DECIMAL);

+----------------------+--------------------------+
| floor(Utf8("100.3")) | floor(Utf8("-127012.3")) |
+----------------------+--------------------------+
| 100.0                | -127013.0                |
+----------------------+--------------------------+

SELECT FLOOR('10.5'::DECIMAL), FLOOR('-10.5'::DECIMAL);

+---------------------+----------------------+
| floor(Utf8("10.5")) | floor(Utf8("-10.5")) |
+---------------------+----------------------+
| 10.0                | -11.0                |
+---------------------+----------------------+

-- floor function on the boundaries
SELECT FLOOR('999.9'::DECIMAL(4,1)), FLOOR('99999999.9'::DECIMAL(9,1)), FLOOR('99999999999999999.9'::DECIMAL(18,1)), FLOOR('9999999999999999999999999999999999999.9'::DECIMAL(38,1));

+----------------------+---------------------------+------------------------------------+--------------------------------------------------------+
| floor(Utf8("999.9")) | floor(Utf8("99999999.9")) | floor(Utf8("99999999999999999.9")) | floor(Utf8("9999999999999999999999999999999999999.9")) |
+----------------------+---------------------------+------------------------------------+--------------------------------------------------------+
| 999.0                | 99999999.0                | 1e17                               | 1e37                                                   |
+----------------------+---------------------------+------------------------------------+--------------------------------------------------------+

SELECT FLOOR('-999.9'::DECIMAL(4,1)), FLOOR('-99999999.9'::DECIMAL(9,1)), FLOOR('-99999999999999999.9'::DECIMAL(18,1)), FLOOR('-9999999999999999999999999999999999999.9'::DECIMAL(38,1));

+-----------------------+----------------------------+-------------------------------------+---------------------------------------------------------+
| floor(Utf8("-999.9")) | floor(Utf8("-99999999.9")) | floor(Utf8("-99999999999999999.9")) | floor(Utf8("-9999999999999999999999999999999999999.9")) |
+-----------------------+----------------------------+-------------------------------------+---------------------------------------------------------+
| -1000.0               | -100000000.0               | -1e17                               | -1e37                                                   |
+-----------------------+----------------------------+-------------------------------------+---------------------------------------------------------+

-- test unary ROUND function
SELECT ROUND('0.1'::DECIMAL), ROUND('-0.1'::DECIMAL), ROUND(NULL::DECIMAL);

+--------------------+---------------------+-------------+
| round(Utf8("0.1")) | round(Utf8("-0.1")) | round(NULL) |
+--------------------+---------------------+-------------+
| 0.0                | -0.0                |             |
+--------------------+---------------------+-------------+

SELECT ROUND('100.3'::DECIMAL), ROUND('-127012.3'::DECIMAL);

+----------------------+--------------------------+
| round(Utf8("100.3")) | round(Utf8("-127012.3")) |
+----------------------+--------------------------+
| 100.0                | -127012.0                |
+----------------------+--------------------------+

SELECT ROUND('10.5'::DECIMAL), ROUND('-10.5'::DECIMAL);

+---------------------+----------------------+
| round(Utf8("10.5")) | round(Utf8("-10.5")) |
+---------------------+----------------------+
| 11.0                | -11.0                |
+---------------------+----------------------+

-- round function on the boundaries
SELECT ROUND('999.9'::DECIMAL(4,1)), ROUND('99999999.9'::DECIMAL(9,1)), ROUND('99999999999999999.9'::DECIMAL(18,1)), ROUND('9999999999999999999999999999999999999.9'::DECIMAL(38,1));

+----------------------+---------------------------+------------------------------------+--------------------------------------------------------+
| round(Utf8("999.9")) | round(Utf8("99999999.9")) | round(Utf8("99999999999999999.9")) | round(Utf8("9999999999999999999999999999999999999.9")) |
+----------------------+---------------------------+------------------------------------+--------------------------------------------------------+
| 1000.0               | 100000000.0               | 1e17                               | 1e37                                                   |
+----------------------+---------------------------+------------------------------------+--------------------------------------------------------+

SELECT ROUND('-999.9'::DECIMAL(4,1)), ROUND('-99999999.9'::DECIMAL(9,1)), ROUND('-99999999999999999.9'::DECIMAL(18,1)), ROUND('-9999999999999999999999999999999999999.9'::DECIMAL(38,1));

+-----------------------+----------------------------+-------------------------------------+---------------------------------------------------------+
| round(Utf8("-999.9")) | round(Utf8("-99999999.9")) | round(Utf8("-99999999999999999.9")) | round(Utf8("-9999999999999999999999999999999999999.9")) |
+-----------------------+----------------------------+-------------------------------------+---------------------------------------------------------+
| -1000.0               | -100000000.0               | -1e17                               | -1e37                                                   |
+-----------------------+----------------------------+-------------------------------------+---------------------------------------------------------+

-- round with precision
SELECT ROUND('100.3908147521'::DECIMAL(18,10), 0)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 1)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 2)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 3)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 4)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 5)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 6)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 7)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 8)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 9)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 10)::VARCHAR,
        ROUND('100.3908147521'::DECIMAL(18,10), 100000)::VARCHAR,
        ROUND(NULL::DECIMAL, 0);

+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+---------------------------------------------+----------------------+
| round(Utf8("100.3908147521"),Int64(0)) | round(Utf8("100.3908147521"),Int64(1)) | round(Utf8("100.3908147521"),Int64(2)) | round(Utf8("100.3908147521"),Int64(3)) | round(Utf8("100.3908147521"),Int64(4)) | round(Utf8("100.3908147521"),Int64(5)) | round(Utf8("100.3908147521"),Int64(6)) | round(Utf8("100.3908147521"),Int64(7)) | round(Utf8("100.3908147521"),Int64(8)) | round(Utf8("100.3908147521"),Int64(9)) | round(Utf8("100.3908147521"),Int64(10)) | round(Utf8("100.3908147521"),Int64(100000)) | round(NULL,Int64(0)) |
+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+---------------------------------------------+----------------------+
| 100.0                                  | 100.4                                  | 100.39                                 | 100.391                                | 100.3908                               | 100.39081                              | 100.390815                             | 100.3908148                            | 100.39081475                           | 100.390814752                          | 100.3908147521                          | NaN                                         |                      |
+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+---------------------------------------------+----------------------+

-- negative precision
SELECT ROUND('1049578239572094512.32415'::DECIMAL(30,10), 0)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -1)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -2)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -3)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -4)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -5)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -6)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -7)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -8)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -9)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -10)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -11)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -12)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -13)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -14)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -15)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -16)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -18)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -19)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -20)::VARCHAR,
        ROUND('1049578239572094512.32415'::DECIMAL(30,10), -19842)::VARCHAR;

+---------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+--------------------------------------------------------+
| round(Utf8("1049578239572094512.32415"),Int64(0)) | round(Utf8("1049578239572094512.32415"),Int64(-1)) | round(Utf8("1049578239572094512.32415"),Int64(-2)) | round(Utf8("1049578239572094512.32415"),Int64(-3)) | round(Utf8("1049578239572094512.32415"),Int64(-4)) | round(Utf8("1049578239572094512.32415"),Int64(-5)) | round(Utf8("1049578239572094512.32415"),Int64(-6)) | round(Utf8("1049578239572094512.32415"),Int64(-7)) | round(Utf8("1049578239572094512.32415"),Int64(-8)) | round(Utf8("1049578239572094512.32415"),Int64(-9)) | round(Utf8("1049578239572094512.32415"),Int64(-10)) | round(Utf8("1049578239572094512.32415"),Int64(-11)) | round(Utf8("1049578239572094512.32415"),Int64(-12)) | round(Utf8("1049578239572094512.32415"),Int64(-13)) | round(Utf8("1049578239572094512.32415"),Int64(-14)) | round(Utf8("1049578239572094512.32415"),Int64(-15)) | round(Utf8("1049578239572094512.32415"),Int64(-16)) | round(Utf8("1049578239572094512.32415"),Int64(-18)) | round(Utf8("1049578239572094512.32415"),Int64(-19)) | round(Utf8("1049578239572094512.32415"),Int64(-20)) | round(Utf8("1049578239572094512.32415"),Int64(-19842)) |
+---------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+--------------------------------------------------------+
| 1.0495782395720946e18                             | 1.0495782395720947e18                              | 1.0495782395720946e18                              | 1.049578239572095e18                               | 1.04957823957209e18                                | 1.0495782395721e18                                 | 1.049578239572e18                                  | 1.04957823957e18                                   | 1.0495782396e18                                    | 1.0495782399999999e18                              | 1.04957824e18                                       | 1.0495782e18                                        | 1.049578e18                                         | 1.04958e18                                          | 1.0496e18                                           | 1.0499999999999999e18                               | 1.05e18                                             | 9.999999999999999e17                                | 0.0                                                 | 0.0                                                 | NaN                                                    |
+---------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+--------------------------------------------------------+

-- negative values
SELECT ROUND('-100.3908147521'::DECIMAL(18,10), 0)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 1)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 2)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 3)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 4)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 5)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 6)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 7)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 8)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 9)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 10)::VARCHAR,
        ROUND('-100.3908147521'::DECIMAL(18,10), 100000)::VARCHAR,
        ROUND(NULL::DECIMAL, 0);

+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+------------------------------------------+----------------------------------------------+----------------------+
| round(Utf8("-100.3908147521"),Int64(0)) | round(Utf8("-100.3908147521"),Int64(1)) | round(Utf8("-100.3908147521"),Int64(2)) | round(Utf8("-100.3908147521"),Int64(3)) | round(Utf8("-100.3908147521"),Int64(4)) | round(Utf8("-100.3908147521"),Int64(5)) | round(Utf8("-100.3908147521"),Int64(6)) | round(Utf8("-100.3908147521"),Int64(7)) | round(Utf8("-100.3908147521"),Int64(8)) | round(Utf8("-100.3908147521"),Int64(9)) | round(Utf8("-100.3908147521"),Int64(10)) | round(Utf8("-100.3908147521"),Int64(100000)) | round(NULL,Int64(0)) |
+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+------------------------------------------+----------------------------------------------+----------------------+
| -100.0                                  | -100.4                                  | -100.39                                 | -100.391                                | -100.3908                               | -100.39081                              | -100.390815                             | -100.3908148                            | -100.39081475                           | -100.390814752                          | -100.3908147521                          | NaN                                          |                      |
+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+-----------------------------------------+------------------------------------------+----------------------------------------------+----------------------+

SELECT ROUND('-1049578239572094512.32415'::DECIMAL(30,10), 0)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -1)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -2)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -3)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -4)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -5)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -6)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -7)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -8)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -9)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -10)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -11)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -12)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -13)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -14)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -15)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -16)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -18)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -19)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -20)::VARCHAR,
        ROUND('-1049578239572094512.32415'::DECIMAL(30,10), -19842)::VARCHAR;

+----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+---------------------------------------------------------+
| round(Utf8("-1049578239572094512.32415"),Int64(0)) | round(Utf8("-1049578239572094512.32415"),Int64(-1)) | round(Utf8("-1049578239572094512.32415"),Int64(-2)) | round(Utf8("-1049578239572094512.32415"),Int64(-3)) | round(Utf8("-1049578239572094512.32415"),Int64(-4)) | round(Utf8("-1049578239572094512.32415"),Int64(-5)) | round(Utf8("-1049578239572094512.32415"),Int64(-6)) | round(Utf8("-1049578239572094512.32415"),Int64(-7)) | round(Utf8("-1049578239572094512.32415"),Int64(-8)) | round(Utf8("-1049578239572094512.32415"),Int64(-9)) | round(Utf8("-1049578239572094512.32415"),Int64(-10)) | round(Utf8("-1049578239572094512.32415"),Int64(-11)) | round(Utf8("-1049578239572094512.32415"),Int64(-12)) | round(Utf8("-1049578239572094512.32415"),Int64(-13)) | round(Utf8("-1049578239572094512.32415"),Int64(-14)) | round(Utf8("-1049578239572094512.32415"),Int64(-15)) | round(Utf8("-1049578239572094512.32415"),Int64(-16)) | round(Utf8("-1049578239572094512.32415"),Int64(-18)) | round(Utf8("-1049578239572094512.32415"),Int64(-19)) | round(Utf8("-1049578239572094512.32415"),Int64(-20)) | round(Utf8("-1049578239572094512.32415"),Int64(-19842)) |
+----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+---------------------------------------------------------+
| -1.0495782395720946e18                             | -1.0495782395720947e18                              | -1.0495782395720946e18                              | -1.049578239572095e18                               | -1.04957823957209e18                                | -1.0495782395721e18                                 | -1.049578239572e18                                  | -1.04957823957e18                                   | -1.0495782396e18                                    | -1.0495782399999999e18                              | -1.04957824e18                                       | -1.0495782e18                                        | -1.049578e18                                         | -1.04958e18                                          | -1.0496e18                                           | -1.0499999999999999e18                               | -1.05e18                                             | -9.999999999999999e17                                | -0.0                                                 | -0.0                                                 | NaN                                                     |
+----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+------------------------------------------------------+---------------------------------------------------------+

SELECT ROUND(12::DECIMAL(3,0));

+------------------+
| round(Int64(12)) |
+------------------+
| 12.0             |
+------------------+

-- null precision becomes null (postgres behavior)
SELECT ROUND(12::DECIMAL(3,0), NULL);

+-----------------------+
| round(Int64(12),NULL) |
+-----------------------+
|                       |
+-----------------------+

-- different types for ROUND
SELECT ROUND('-100.3'::DECIMAL(4,1), 1)::VARCHAR,
        ROUND('104.3'::DECIMAL(4,1), 0)::VARCHAR,
        ROUND('104.3'::DECIMAL(4,1), -1)::VARCHAR;

+--------------------------------+-------------------------------+--------------------------------+
| round(Utf8("-100.3"),Int64(1)) | round(Utf8("104.3"),Int64(0)) | round(Utf8("104.3"),Int64(-1)) |
+--------------------------------+-------------------------------+--------------------------------+
| -100.3                         | 104.0                         | 100.0                          |
+--------------------------------+-------------------------------+--------------------------------+

SELECT ROUND('-100.3'::DECIMAL(9,1), 1)::VARCHAR,
        ROUND('104.3'::DECIMAL(9,1), 0)::VARCHAR,
        ROUND('104.3'::DECIMAL(9,1), -1)::VARCHAR;

+--------------------------------+-------------------------------+--------------------------------+
| round(Utf8("-100.3"),Int64(1)) | round(Utf8("104.3"),Int64(0)) | round(Utf8("104.3"),Int64(-1)) |
+--------------------------------+-------------------------------+--------------------------------+
| -100.3                         | 104.0                         | 100.0                          |
+--------------------------------+-------------------------------+--------------------------------+

SELECT ROUND('-100.3'::DECIMAL(18,1), 1)::VARCHAR,
        ROUND('104.3'::DECIMAL(18,1), 0)::VARCHAR,
        ROUND('104.3'::DECIMAL(18,1), -1)::VARCHAR;

+--------------------------------+-------------------------------+--------------------------------+
| round(Utf8("-100.3"),Int64(1)) | round(Utf8("104.3"),Int64(0)) | round(Utf8("104.3"),Int64(-1)) |
+--------------------------------+-------------------------------+--------------------------------+
| -100.3                         | 104.0                         | 100.0                          |
+--------------------------------+-------------------------------+--------------------------------+

-- use decimal in sub-query
SELECT (SELECT '1.0'::DECIMAL(2,1));

+-------------+
| Utf8("1.0") |
+-------------+
| 1.0         |
+-------------+

-- test join with decimals
CREATE TABLE tmp_table(i INTEGER, ts timestamp time index);

Affected Rows: 0

INSERT INTO tmp_table VALUES (1, 1000), (2, 2000), (3, 3000);

Affected Rows: 3

-- SQLNESS SORT_RESULT 3 1
SELECT * FROM tmp_table;

+---+---------------------+
| i | ts                  |
+---+---------------------+
| 1 | 1970-01-01T00:00:01 |
| 2 | 1970-01-01T00:00:02 |
| 3 | 1970-01-01T00:00:03 |
+---+---------------------+

-- SQLNESS SORT_RESULT 3 1
SELECT * FROM tmp_table JOIN decimals ON decimals.ts = tmp_table.ts;

+---+---------------------+------+---------------------+
| i | ts                  | d    | ts                  |
+---+---------------------+------+---------------------+
| 1 | 1970-01-01T00:00:01 | 0.10 | 1970-01-01T00:00:01 |
| 2 | 1970-01-01T00:00:02 | 0.20 | 1970-01-01T00:00:02 |
+---+---------------------+------+---------------------+

DROP TABLE decimals;

Affected Rows: 0

DROP TABLE tmp_table;

Affected Rows: 0

