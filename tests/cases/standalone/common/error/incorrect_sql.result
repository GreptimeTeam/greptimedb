-- Migrated from DuckDB test: test/sql/error/incorrect_sql.test
-- Description: Test various incorrect SQL strings
-- Note: Adapted for GreptimeDB error handling validation
-- Test 1: Typo in SELECT keyword
-- ERROR
SELEC 42;

Error: 1001(Unsupported), SQL statement is not supported, keyword: SELEC

-- Test 2: Unrecognized column  
-- ERROR
SELECT x FROM (SELECT 1 as y);

Error: 3000(PlanQuery), Failed to plan SQL: No field named x. Valid fields are y.

-- Test 3: Unrecognized scalar function
-- ERROR
SELECT FUNFUNFUN();

Error: 3000(PlanQuery), Failed to plan SQL: Error during planning: Invalid function 'funfunfun'.
Did you mean 'range_fn'?

-- Test 4: Incorrect aggregate parameters
-- ERROR
SELECT SUM(42, 84, 11, 'hello');

Error: 3000(PlanQuery), Failed to plan SQL: Error during planning: Execution error: Function 'sum' user-defined coercion failed with "Execution error: sum function requires 1 argument, got 4" No function matches the given name and argument types 'sum(Int64, Int64, Int64, Utf8)'. You might need to add explicit type casts.
	Candidate functions:
	sum(UserDefined)

-- Test 5: No matching function signature
-- ERROR  
SELECT cos(0, 1, 2, 3);

Error: 3000(PlanQuery), Failed to plan SQL: Error during planning: Failed to coerce arguments to satisfy a call to 'cos' function: coercion from [Int64, Int64, Int64, Int64] to the signature Uniform(1, [Float64, Float32]) failed No function matches the given name and argument types 'cos(Int64, Int64, Int64, Int64)'. You might need to add explicit type casts.
	Candidate functions:
	cos(Float64/Float32)

-- Test 6: Multiple WHERE clauses
-- ERROR
SELECT 42 WHERE 1=1 WHERE 1=0;

Error: 1001(Unsupported), SQL statement is not supported, keyword: WHERE

-- Test 7: Multiple statements without semicolon
-- ERROR
SELECT 42
SELECT 42;

Error: 1001(Unsupported), SQL statement is not supported, keyword: SELECT

-- Test 8: Non-existent table
-- ERROR
SELECT * FROM integers2;

Error: 4001(TableNotFound), Failed to plan SQL: Table not found: greptime.public.integers2

-- Test 9: Non-existent schema
-- ERROR
SELECT * FROM bla.integers2;

Error: 4001(TableNotFound), Failed to plan SQL: Table not found: greptime.bla.integers2

-- Create test tables for column error tests
CREATE TABLE integers(integ INTEGER, ts TIMESTAMP TIME INDEX);

Affected Rows: 0

CREATE TABLE strings(str VARCHAR, ts TIMESTAMP TIME INDEX);

Affected Rows: 0

CREATE TABLE chickens(feather INTEGER, beak INTEGER, ts TIMESTAMP TIME INDEX);

Affected Rows: 0

-- Test 10: Non-existent column
-- ERROR
SELECT feathe FROM chickens;

Error: 3000(PlanQuery), Failed to plan SQL: No field named feathe. Valid fields are chickens.feather, chickens.beak, chickens.ts.

-- Test 11: Non-existent column with multiple tables
-- ERROR
SELECT feathe FROM chickens, integers, strings;

Error: 3000(PlanQuery), Failed to plan SQL: No field named feathe. Valid fields are chickens.feather, chickens.beak, chickens.ts, integers.integ, integers.ts, strings.str, strings.ts.

-- Test 12: Ambiguous column reference without qualifier
-- ERROR
SELECT ts FROM chickens, integers;

Error: 3000(PlanQuery), Failed to plan SQL: Ambiguous reference to unqualified field ts

-- Clean up
DROP TABLE chickens;

Affected Rows: 0

DROP TABLE strings;  
DROP TABLE integers;

Error: 1001(Unsupported), Not supported: execute multiple statements in SQL query string through GRPC interface

