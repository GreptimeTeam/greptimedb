-- String length function tests
-- LENGTH function
SELECT LENGTH('hello');

+-----------------------+
| length(Utf8("hello")) |
+-----------------------+
| 5                     |
+-----------------------+

SELECT LENGTH('');

+------------------+
| length(Utf8("")) |
+------------------+
| 0                |
+------------------+

SELECT LENGTH(NULL);

+--------------+
| length(NULL) |
+--------------+
|              |
+--------------+

SELECT LENGTH('hello world');

+-----------------------------+
| length(Utf8("hello world")) |
+-----------------------------+
| 11                          |
+-----------------------------+

-- CHAR_LENGTH (character length)
SELECT CHAR_LENGTH('hello');

+----------------------------+
| char_length(Utf8("hello")) |
+----------------------------+
| 5                          |
+----------------------------+

SELECT CHAR_LENGTH('');

+-----------------------+
| char_length(Utf8("")) |
+-----------------------+
| 0                     |
+-----------------------+

SELECT CHAR_LENGTH(NULL);

+-------------------+
| char_length(NULL) |
+-------------------+
|                   |
+-------------------+

-- CHARACTER_LENGTH (alias for CHAR_LENGTH)
SELECT CHARACTER_LENGTH('hello world');

+---------------------------------------+
| character_length(Utf8("hello world")) |
+---------------------------------------+
| 11                                    |
+---------------------------------------+

-- Unicode character length
SELECT LENGTH('ä¸–ç•Œ') AS a, CHAR_LENGTH('ä¸–ç•Œ') AS b;

+---+---+
| a | b |
+---+---+
| 2 | 2 |
+---+---+

SELECT LENGTH('ðŸš€ðŸŒŸ') AS a, CHAR_LENGTH('ðŸš€ðŸŒŸ') AS b;

+---+---+
| a | b |
+---+---+
| 2 | 2 |
+---+---+

SELECT LENGTH('cafÃ©') AS a, CHAR_LENGTH('cafÃ©') AS b;

+---+---+
| a | b |
+---+---+
| 4 | 4 |
+---+---+

-- Test with table data
CREATE TABLE length_test(s VARCHAR, ts TIMESTAMP TIME INDEX);

Affected Rows: 0

INSERT INTO length_test VALUES
    ('hello', 1000),
    ('world!', 2000),
    ('', 3000),
    ('ä¸­æ–‡æµ‹è¯•', 4000),
    ('ðŸš€ðŸŽ‰ðŸŒŸ', 5000),
    (NULL, 6000);

Affected Rows: 6

SELECT s, LENGTH(s) AS a, CHAR_LENGTH(s) AS b FROM length_test ORDER BY ts;

+----------+---+---+
| s        | a | b |
+----------+---+---+
| hello    | 5 | 5 |
| world!   | 6 | 6 |
|          | 0 | 0 |
| ä¸­æ–‡æµ‹è¯• | 4 | 4 |
| ðŸš€ðŸŽ‰ðŸŒŸ   | 3 | 3 |
|          |   |   |
+----------+---+---+

-- BIT_LENGTH (length in bits)
SELECT BIT_LENGTH('hello');

+---------------------------+
| bit_length(Utf8("hello")) |
+---------------------------+
| 40                        |
+---------------------------+

SELECT BIT_LENGTH('');

+----------------------+
| bit_length(Utf8("")) |
+----------------------+
| 0                    |
+----------------------+

SELECT BIT_LENGTH('ä¸–ç•Œ');

+--------------------------+
| bit_length(Utf8("ä¸–ç•Œ")) |
+--------------------------+
| 48                       |
+--------------------------+

-- OCTET_LENGTH (length in bytes)
SELECT OCTET_LENGTH('hello');

+-----------------------------+
| octet_length(Utf8("hello")) |
+-----------------------------+
| 5                           |
+-----------------------------+

SELECT OCTET_LENGTH('');

+------------------------+
| octet_length(Utf8("")) |
+------------------------+
| 0                      |
+------------------------+

SELECT OCTET_LENGTH('ä¸–ç•Œ');

+----------------------------+
| octet_length(Utf8("ä¸–ç•Œ")) |
+----------------------------+
| 6                          |
+----------------------------+

SELECT OCTET_LENGTH('ðŸš€');

+--------------------------+
| octet_length(Utf8("ðŸš€")) |
+--------------------------+
| 4                        |
+--------------------------+

DROP TABLE length_test;

Affected Rows: 0

