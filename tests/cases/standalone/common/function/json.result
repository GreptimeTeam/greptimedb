-- get_by_path functions --
SELECT get_by_path_int(to_json('{"a": {"b": {"c": 1}}}'), 'a.b.c');

+------------------------------------------------------------------------+
| get_by_path_int(to_json(Utf8("{"a": {"b": {"c": 1}}}")),Utf8("a.b.c")) |
+------------------------------------------------------------------------+
| 1                                                                      |
+------------------------------------------------------------------------+

SELECT get_by_path_float(to_json('{"a": {"b": {"c": 1.234}}}'), 'a.b.c');

+------------------------------------------------------------------------------+
| get_by_path_float(to_json(Utf8("{"a": {"b": {"c": 1.234}}}")),Utf8("a.b.c")) |
+------------------------------------------------------------------------------+
| 1.234                                                                        |
+------------------------------------------------------------------------------+

SELECT get_by_path_string(to_json('{"a": {"b": {"c": "foo"}}}'), 'a.b.c');

+-------------------------------------------------------------------------------+
| get_by_path_string(to_json(Utf8("{"a": {"b": {"c": "foo"}}}")),Utf8("a.b.c")) |
+-------------------------------------------------------------------------------+
| foo                                                                           |
+-------------------------------------------------------------------------------+

SELECT get_by_path_bool(to_json('{"a": {"b": {"c": true}}}'), 'a.b.c');

+----------------------------------------------------------------------------+
| get_by_path_bool(to_json(Utf8("{"a": {"b": {"c": true}}}")),Utf8("a.b.c")) |
+----------------------------------------------------------------------------+
| true                                                                       |
+----------------------------------------------------------------------------+

SELECT get_by_path_int(to_json('{"a": {"b": {"c": {"d": 1}}}}'), 'a.b');

+-----------------------------------------------------------------------------+
| get_by_path_int(to_json(Utf8("{"a": {"b": {"c": {"d": 1}}}}")),Utf8("a.b")) |
+-----------------------------------------------------------------------------+
|                                                                             |
+-----------------------------------------------------------------------------+

SELECT get_by_path_string(to_json('{"a": {"b": {"c": {"d": 1}}}}'), 'a.b');

+--------------------------------------------------------------------------------+
| get_by_path_string(to_json(Utf8("{"a": {"b": {"c": {"d": 1}}}}")),Utf8("a.b")) |
+--------------------------------------------------------------------------------+
|                                                                                |
+--------------------------------------------------------------------------------+

-- test functions with table rows --
CREATE TABLE jsons(j JSON, ts timestamp time index);

Affected Rows: 0

INSERT INTO jsons VALUES(to_json('{"a": {"b": {"c": 1}}}'), 1);

Affected Rows: 1

INSERT INTO jsons VALUES(to_json('{"a": {"b": {"c": 1.234}}}'), 2);

Affected Rows: 1

INSERT INTO jsons VALUES(to_json('{"a": {"b": {"c": "foo"}}}'), 3);

Affected Rows: 1

INSERT INTO jsons VALUES(to_json('{"a": {"b": {"c": true}}}'), 4);

Affected Rows: 1

SELECT get_by_path_int(j, 'a.b.c') FROM jsons;

+----------------------------------------+
| get_by_path_int(jsons.j,Utf8("a.b.c")) |
+----------------------------------------+
| 1                                      |
|                                        |
|                                        |
| 1                                      |
+----------------------------------------+

SELECT get_by_path_float(j, 'a.b.c') FROM jsons;

+------------------------------------------+
| get_by_path_float(jsons.j,Utf8("a.b.c")) |
+------------------------------------------+
| 1.0                                      |
| 1.234                                    |
|                                          |
| 1.0                                      |
+------------------------------------------+

SELECT get_by_path_string(j, 'a.b.c') FROM jsons;

+-------------------------------------------+
| get_by_path_string(jsons.j,Utf8("a.b.c")) |
+-------------------------------------------+
| 1                                         |
| 1.234                                     |
| foo                                       |
| true                                      |
+-------------------------------------------+

SELECT get_by_path_bool(j, 'a.b.c') FROM jsons;

+-----------------------------------------+
| get_by_path_bool(jsons.j,Utf8("a.b.c")) |
+-----------------------------------------+
|                                         |
|                                         |
|                                         |
| true                                    |
+-----------------------------------------+

SELECT get_by_path_int(j, 'd') FROM jsons;

+------------------------------------+
| get_by_path_int(jsons.j,Utf8("d")) |
+------------------------------------+
|                                    |
|                                    |
|                                    |
|                                    |
+------------------------------------+

DROP TABLE jsons;

Affected Rows: 0

