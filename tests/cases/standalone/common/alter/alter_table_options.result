CREATE TABLE ato(i INTEGER, j TIMESTAMP TIME INDEX, PRIMARY KEY(i));

Affected Rows: 0

INSERT INTO ato VALUES(1, now()), (2, now());

Affected Rows: 2

SELECT i FROM ato;

+---+
| i |
+---+
| 1 |
| 2 |
+---+

ALTER TABLE ato SET 'ttl'='1d';

Affected Rows: 0

SELECT i FROM ato;

+---+
| i |
+---+
| 1 |
| 2 |
+---+

SHOW CREATE TABLE ato;

+-------+------------------------------------+
| Table | Create Table                       |
+-------+------------------------------------+
| ato   | CREATE TABLE IF NOT EXISTS "ato" ( |
|       |   "i" INT NULL,                    |
|       |   "j" TIMESTAMP(3) NOT NULL,       |
|       |   TIME INDEX ("j"),                |
|       |   PRIMARY KEY ("i")                |
|       | )                                  |
|       |                                    |
|       | ENGINE=mito                        |
|       | WITH(                              |
|       |   ttl = '1day'                     |
|       | )                                  |
+-------+------------------------------------+

ALTER TABLE ato SET 'ttl'='2d';

Affected Rows: 0

SELECT i FROM ato;

+---+
| i |
+---+
| 1 |
| 2 |
+---+

SHOW CREATE TABLE ato;

+-------+------------------------------------+
| Table | Create Table                       |
+-------+------------------------------------+
| ato   | CREATE TABLE IF NOT EXISTS "ato" ( |
|       |   "i" INT NULL,                    |
|       |   "j" TIMESTAMP(3) NOT NULL,       |
|       |   TIME INDEX ("j"),                |
|       |   PRIMARY KEY ("i")                |
|       | )                                  |
|       |                                    |
|       | ENGINE=mito                        |
|       | WITH(                              |
|       |   ttl = '2days'                    |
|       | )                                  |
+-------+------------------------------------+

ALTER TABLE ato SET 'ttl'=NULL;

Affected Rows: 0

SELECT i FROM ato;

+---+
| i |
+---+
| 1 |
| 2 |
+---+

SHOW CREATE TABLE ato;

+-------+------------------------------------+
| Table | Create Table                       |
+-------+------------------------------------+
| ato   | CREATE TABLE IF NOT EXISTS "ato" ( |
|       |   "i" INT NULL,                    |
|       |   "j" TIMESTAMP(3) NOT NULL,       |
|       |   TIME INDEX ("j"),                |
|       |   PRIMARY KEY ("i")                |
|       | )                                  |
|       |                                    |
|       | ENGINE=mito                        |
|       |                                    |
+-------+------------------------------------+

ALTER TABLE ato SET 'ttl'='1s';

Affected Rows: 0

SHOW CREATE TABLE ato;

+-------+------------------------------------+
| Table | Create Table                       |
+-------+------------------------------------+
| ato   | CREATE TABLE IF NOT EXISTS "ato" ( |
|       |   "i" INT NULL,                    |
|       |   "j" TIMESTAMP(3) NOT NULL,       |
|       |   TIME INDEX ("j"),                |
|       |   PRIMARY KEY ("i")                |
|       | )                                  |
|       |                                    |
|       | ENGINE=mito                        |
|       | WITH(                              |
|       |   ttl = '1s'                       |
|       | )                                  |
+-------+------------------------------------+

SELECT i FROM ato;

+---+
| i |
+---+
| 1 |
| 2 |
+---+

ALTER TABLE ato SET 'compaction.twcs.time_window'='2h';

Affected Rows: 0

ALTER TABLE ato SET 'compaction.twcs.max_output_file_size'='500MB';

Affected Rows: 0

ALTER TABLE ato SET 'compaction.twcs.max_inactive_window_files'='2';

Affected Rows: 0

ALTER TABLE ato SET 'compaction.twcs.max_active_window_files'='2';

Affected Rows: 0

ALTER TABLE ato SET 'compaction.twcs.max_active_window_runs'='6';

Affected Rows: 0

ALTER TABLE ato SET 'compaction.twcs.max_inactive_window_runs'='6';

Affected Rows: 0

SHOW CREATE TABLE ato;

+-------+----------------------------------------------------+
| Table | Create Table                                       |
+-------+----------------------------------------------------+
| ato   | CREATE TABLE IF NOT EXISTS "ato" (                 |
|       |   "i" INT NULL,                                    |
|       |   "j" TIMESTAMP(3) NOT NULL,                       |
|       |   TIME INDEX ("j"),                                |
|       |   PRIMARY KEY ("i")                                |
|       | )                                                  |
|       |                                                    |
|       | ENGINE=mito                                        |
|       | WITH(                                              |
|       |   compaction.twcs.max_active_window_files = '2',   |
|       |   compaction.twcs.max_active_window_runs = '6',    |
|       |   compaction.twcs.max_inactive_window_files = '2', |
|       |   compaction.twcs.max_inactive_window_runs = '6',  |
|       |   compaction.twcs.max_output_file_size = '500MB',  |
|       |   compaction.twcs.time_window = '2h',              |
|       |   compaction.type = 'twcs',                        |
|       |   ttl = '1s'                                       |
|       | )                                                  |
+-------+----------------------------------------------------+

ALTER TABLE ato UNSET 'compaction.twcs.time_window';

Affected Rows: 0

SHOW CREATE TABLE ato;

+-------+----------------------------------------------------+
| Table | Create Table                                       |
+-------+----------------------------------------------------+
| ato   | CREATE TABLE IF NOT EXISTS "ato" (                 |
|       |   "i" INT NULL,                                    |
|       |   "j" TIMESTAMP(3) NOT NULL,                       |
|       |   TIME INDEX ("j"),                                |
|       |   PRIMARY KEY ("i")                                |
|       | )                                                  |
|       |                                                    |
|       | ENGINE=mito                                        |
|       | WITH(                                              |
|       |   compaction.twcs.max_active_window_files = '2',   |
|       |   compaction.twcs.max_active_window_runs = '6',    |
|       |   compaction.twcs.max_inactive_window_files = '2', |
|       |   compaction.twcs.max_inactive_window_runs = '6',  |
|       |   compaction.twcs.max_output_file_size = '500MB',  |
|       |   compaction.type = 'twcs',                        |
|       |   ttl = '1s'                                       |
|       | )                                                  |
+-------+----------------------------------------------------+

-- SQLNESS ARG restart=true
SHOW CREATE TABLE ato;

+-------+----------------------------------------------------+
| Table | Create Table                                       |
+-------+----------------------------------------------------+
| ato   | CREATE TABLE IF NOT EXISTS "ato" (                 |
|       |   "i" INT NULL,                                    |
|       |   "j" TIMESTAMP(3) NOT NULL,                       |
|       |   TIME INDEX ("j"),                                |
|       |   PRIMARY KEY ("i")                                |
|       | )                                                  |
|       |                                                    |
|       | ENGINE=mito                                        |
|       | WITH(                                              |
|       |   compaction.twcs.max_active_window_files = '2',   |
|       |   compaction.twcs.max_active_window_runs = '6',    |
|       |   compaction.twcs.max_inactive_window_files = '2', |
|       |   compaction.twcs.max_inactive_window_runs = '6',  |
|       |   compaction.twcs.max_output_file_size = '500MB',  |
|       |   compaction.type = 'twcs',                        |
|       |   ttl = '1s'                                       |
|       | )                                                  |
+-------+----------------------------------------------------+

DROP TABLE ato;

Affected Rows: 0

