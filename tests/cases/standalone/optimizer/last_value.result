create table t (
    ts timestamp time index,
    host string primary key,
    not_pk string,
    val double,
);

Affected Rows: 0

insert into t values
    (0, 'a', 'ðŸŒ•', 1.0),
    (1, 'b', 'ðŸŒ–', 2.0),
    (2, 'a', 'ðŸŒ—', 3.0),
    (3, 'c', 'ðŸŒ˜', 4.0),
    (4, 'a', 'ðŸŒ‘', 5.0),
    (5, 'b', 'ðŸŒ’', 6.0),
    (6, 'a', 'ðŸŒ“', 7.0),
    (7, 'c', 'ðŸŒ”', 8.0),
    (8, 'd', 'ðŸŒ•', 9.0);

Affected Rows: 9

-- SQLNESS REPLACE (metrics.*) REDACTED
explain analyze
    select
        last_value(host order by ts),
        last_value(not_pk order by ts),
        last_value(val order by ts)
    from t
    group by host;

+-------+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| stage | node | plan                                                                                                                                                                                                                                                                                                                                                                                                      |
+-------+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0     | 0    |  MergeScanExec: peers=[5695126634496(1326, 0), ] REDACTED
|       |      |                                                                                                                                                                                                                                                                                                                                                                                                           |
| 1     | 0    |  ProjectionExec: expr=[last_value(t.host) ORDER BY [t.ts ASC NULLS LAST]@1 as last_value(t.host) ORDER BY [t.ts ASC NULLS LAST], last_value(t.not_pk) ORDER BY [t.ts ASC NULLS LAST]@2 as last_value(t.not_pk) ORDER BY [t.ts ASC NULLS LAST], last_value(t.val) ORDER BY [t.ts ASC NULLS LAST]@3 as last_value(t.val) ORDER BY [t.ts ASC NULLS LAST]] REDACTED
|       |      |   AggregateExec: mode=FinalPartitioned, gby=[host@0 as host], aggr=[last_value(t.host) ORDER BY [t.ts ASC NULLS LAST], last_value(t.not_pk) ORDER BY [t.ts ASC NULLS LAST], last_value(t.val) ORDER BY [t.ts ASC NULLS LAST]] REDACTED
|       |      |     CoalesceBatchesExec: target_batch_size=8192 REDACTED
|       |      |       RepartitionExec: partitioning=Hash([host@0], 10), input_partitions=10 REDACTED
|       |      |         CoalesceBatchesExec: target_batch_size=8192 REDACTED
|       |      |           AggregateExec: mode=Partial, gby=[host@1 as host], aggr=[last_value(t.host) ORDER BY [t.ts ASC NULLS LAST], last_value(t.not_pk) ORDER BY [t.ts ASC NULLS LAST], last_value(t.val) ORDER BY [t.ts ASC NULLS LAST]] REDACTED
|       |      |             RepartitionExec: partitioning=RoundRobinBatch(10), input_partitions=3 REDACTED
|       |      |               SeqScan: partition_count=1 (1 memtable ranges, 0 file ranges), selector=LastRow REDACTED
|       |      |                                                                                                                                                                                                                                                                                                                                                                                                           |
|       |      | Total rows: 4                                                                                                                                                                                                                                                                                                                                                                                             |
+-------+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

drop table t;

Affected Rows: 0

